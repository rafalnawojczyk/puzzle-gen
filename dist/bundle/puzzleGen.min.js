!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.puzzleGen=e():t.puzzleGen=e()}(this,(function(){return(()=>{"use strict";var t={302:(t,e,s)=>{s.r(e),s.d(e,{Algorithm:()=>_e,Colors:()=>a,Masks:()=>Oe,PNG:()=>Ae,PuzzleGeometry:()=>We,Rendering:()=>je,SVG:()=>Ge,Simulator:()=>$e,SvgVisualizer:()=>SvgVisualizer,Type:()=>ue,Visualizer:()=>Visualizer,validColor:()=>Me,validatePuzzleOptions:()=>Le});var i,r,o,a={};s.r(a),s.d(a,{BLACK:()=>v,BLUE:()=>m,BLUE_STICKERLESS:()=>B,DARK_BLUE:()=>C,DARK_BLUE_STICKERLESS:()=>U,GREEN:()=>k,GREEN_STICKERLESS:()=>x,GREY:()=>y,GREY_STICKERLESS:()=>D,LIGHT_GREEN:()=>E,LIGHT_GREEN_STICKERLESS:()=>z,LIGHT_YELLOW:()=>F,LIGHT_YELLOW_STICKERLESS:()=>G,MASK_COLOR:()=>L,ORANGE:()=>w,ORANGE_STICKERLESS:()=>I,PINK:()=>R,PINK_STICKERLESS:()=>A,PURPLE:()=>S,PURPLE_STICKERLESS:()=>N,RED:()=>p,RED_STICKERLESS:()=>P,WHITE:()=>g,WHITE_STICKERLESS:()=>T,YELLOW:()=>b,YELLOW_STICKERLESS:()=>M}),function(t){t[t.Clockwise=0]="Clockwise",t[t.CounterClockwise=1]="CounterClockwise",t[t.Double=2]="Double"}(i||(i={})),function(t){t.Clockwise="",t.CounterClockwise="'",t.Double="2"}(r||(r={})),function(t){t.F="F",t.U="U",t.R="R",t.L="L",t.D="D",t.B="B",t.M="M",t.E="E",t.S="S",t.X="x",t.Y="y",t.Z="z"}(o||(o={}));const n=[o.F,o.U,o.R,o.L,o.D,o.B,o.M,o.E,o.S,o.X,o.Y,o.Z],h=[o.X,o.Y,o.Z],c=/([2-9]+)?([UuFfRrDdLlBbMESxyz])(w)?([2\'])?/g;function l(t){if(!t)return[];let e,s=[];for(;e=c.exec(t);){let t=e[1],i=e[2],o=e[3],a=e[4]||r.Clockwise,n=i===i.toLowerCase()&&-1===h.indexOf(i);n&&(i=i.toUpperCase());let c={unit:d(i),turnType:f(a),slices:n?2:u(t,o)};s.push(c)}return s}function u(t,e){if(e&&!t)return 2;if(!e&&t)throw new Error("Invalid move: Cannot specify num slices if outer block move indicator 'w' is not present");return e||t?parseInt(t):1}function d(t){if(n.indexOf(t)<0)throw new Error(`Invalid move (${t}): Possible turn faces are [U R F L D B M E S x y z]`);return t}function f(t){switch(t){case r.Clockwise:return i.Clockwise;case r.CounterClockwise:return i.CounterClockwise;case r.Double:return i.Double;default:throw new Error(`Invalid move modifier (${t})`)}}class Simulator{constructor(){this.stickers=new Map,this.faces=new Map,this.turns=new Map}addFace(t,e){if(e&&this.faces.has(e))throw`Face ${e} already exists`;e||(e=(this.faces.size+1).toString());const s=t.reduce(((t,e)=>{const s=(this.stickers.size+1).toString();return this.stickers.set(s,e),t.push(s),t}),[]);return this.faces.set(e,s),{faceId:e,stickerIds:s}}addTurn(t,e){if(e&&this.turns.has(e))throw`Turn ${e} already exists`;return e||(e=(this.turns.size+1).toString()),this.turns.set(e,t),e}doTurn(t,e=!1){const s=this.turns.get(t);if(!s)throw`Unknown turn ${t}`;let i=e?1:0,r=e?0:1,o={};s.forEach((t=>{o[t[r]]=this.stickers.get(t[r]),this.stickers.set(t[r],o[t[i]]||this.stickers.get(t[i]))}))}isSolved(){const t=this.faces.entries();let e=t.next();do{const s=e.value[1];let i=this.stickers.get(s[0]);for(let t of s)if(i!=this.stickers.get(t))return!1;e=t.next()}while(!e.done);return!0}getValues(){let t={};return this.faces.forEach(((e,s)=>{t[s]=e.map((t=>this.stickers.get(t)))})),t}setValue(t,e,s){if(!this.faces.has(t))return void console.warn(`attempting to set sticker value on invalid face: ${t}`);let i=this.faces.get(t),r=i[e];i?this.stickers.set(r,s):console.warn(`attempting to set sticker value for invalid sticker: ${t} ${e}`)}alg(t){t&&t.split(" ").forEach((t=>this.doTurn(t)))}case(t){}reset(){this.faces.forEach(((t,e)=>{t.forEach((t=>{this.stickers.set(t,e)}))}))}}const b={value:"#FFFF00"},p={value:"#FF0000"},m={value:"#0000FF"},g={value:"#FFFFFF"},w={value:"#FFA500"},k={value:"#00FF00"},S={value:"#800080"},y={value:"#808080"},C={value:"#00008B"},F={value:"#ffffb3"},E={value:"#32CD32"},R={value:"#FF69B4"},v={value:"#000000"},L={value:"#404040"},M={value:"#FFFF00",stroke:"#DDDD00"},P={value:"#FF0000",stroke:"#DD0000"},B={value:"#0000FF",stroke:"#0000DD"},T={value:"#FFFFFF",stroke:"#DDD"},I={value:"#FFA500",stroke:"#DD8500"},x={value:"#00FF00",stroke:"#00DD00"},N={value:"#800080",stroke:"#5c005c"},D={value:"#808080",stroke:"#6b6b6b"},U={value:"#00008B",stroke:"#000075"},G={value:"#ffffb3",stroke:"#e6e6a3"},z={value:"#32CD32",stroke:"#2db32d"},A={value:"#FF69B4",stroke:"#de5b9c"};var O;!function(t){t[t.CORNER=0]="CORNER",t[t.EDGE=1]="EDGE",t[t.MIDDLE=2]="MIDDLE"}(O||(O={}));const j=[.96875,-.24803,0],W=b,$=g,_=p,q=m,H=k,X=w,Y={top:W,front:_,bottom:$,left:q,right:H,back:X},K=[{type:O.CORNER,colors:[W,_,q]},{type:O.EDGE,colors:[W,q]},{type:O.CORNER,colors:[W,q,X]},{type:O.EDGE,colors:[W,X]},{type:O.CORNER,colors:[W,X,H]},{type:O.EDGE,colors:[W,H]},{type:O.CORNER,colors:[W,H,_]},{type:O.EDGE,colors:[W,_]}],V=[{type:O.EDGE,colors:[$,X]},{type:O.CORNER,colors:[$,X,q]},{type:O.EDGE,colors:[$,q]},{type:O.CORNER,colors:[$,q,_]},{type:O.EDGE,colors:[$,_]},{type:O.CORNER,colors:[$,_,H]},{type:O.EDGE,colors:[$,H]},{type:O.CORNER,colors:[$,H,X]}],Z=/(\/|\((-?\d),(-?\d)\))/g;function Q(t){let e,s=[];for(;e=Z.exec(t);)"/"===e[0]?s.push({slice:!0}):s.push({top:parseInt(e[2]),bottom:parseInt(e[3])});return s}const J={[O.CORNER]:2,[O.EDGE]:1};class Square1Simualtor extends Simulator{constructor(t=Y){super(),this.scheme=t,this.topLayer=function(t){return[{type:O.CORNER,colors:[t.top||W,t.front||_,t.left||q]},{type:O.EDGE,colors:[t.top||W,t.left||q]},{type:O.CORNER,colors:[t.top||W,t.left||q,t.back||X]},{type:O.EDGE,colors:[t.top||W,t.back||X]},{type:O.CORNER,colors:[t.top||W,t.back||X,t.right||H]},{type:O.EDGE,colors:[t.top||W,t.right||H]},{type:O.CORNER,colors:[t.top||W,t.right||H,t.front||_]},{type:O.EDGE,colors:[t.top||W,t.front||_]}]}(this.scheme),this.bottomLayer=function(t){return[{type:O.EDGE,colors:[t.bottom||$,t.back||X]},{type:O.CORNER,colors:[t.bottom||$,t.back||X,t.left||q]},{type:O.EDGE,colors:[t.bottom||$,t.left||q]},{type:O.CORNER,colors:[t.bottom||$,t.left||q,t.front||_]},{type:O.EDGE,colors:[t.bottom||$,t.front||_]},{type:O.CORNER,colors:[t.bottom||$,t.front||_,t.right||H]},{type:O.EDGE,colors:[t.bottom||$,t.right||H]},{type:O.CORNER,colors:[t.bottom||$,t.right||H,t.back||X]}]}(this.scheme),this.middleRotated=!1}alg(t){Q(t).forEach((t=>{"slice"in t?this.slice():(this.rotateTop(t.top),this.rotateBottom(t.bottom))}))}case(t){Q(t).reverse().forEach((t=>{"slice"in t?this.slice():(this.rotateTop(-1*t.top),this.rotateBottom(-1*t.bottom))}))}slice(){let t=0,e=0;for(let e=this.topLayer.length,s=0;e>0&&s<6;e--)s+=J[this.topLayer[e-1].type],t++;for(let t=this.bottomLayer.length,s=0;t>0&&s<6;t--)s+=J[this.bottomLayer[t-1].type],e++;const s=this.topLayer.splice(this.topLayer.length-t,this.topLayer.length),i=this.bottomLayer.splice(this.bottomLayer.length-e,this.bottomLayer.length);this.topLayer=this.topLayer.concat(i),this.bottomLayer=this.bottomLayer.concat(s),this.middleRotated=!this.middleRotated}rotateTop(t){for(;0!=t;)if(t<0){const e=this.topLayer.shift(),s=J[e.type];if(Math.abs(t)<s)throw"Invalid Square1 Move";this.topLayer.push(e),t+=s}else{const e=this.topLayer.pop(),s=J[e.type];if(Math.abs(t)<s)throw"Invalid Square1 Move";this.topLayer.unshift(e),t-=s}}rotateBottom(t){for(;0!=t;)if(t<0){const e=this.bottomLayer.shift(),s=J[e.type];if(Math.abs(t)<s)throw"Invalid Square1 Move";this.bottomLayer.push(e),t+=s}else{const e=this.bottomLayer.pop(),s=J[e.type];if(Math.abs(t)<s)throw"Invalid Square1 Move";this.bottomLayer.unshift(e),t-=s}}}const tt=/([LRUB])(\'?)/g,et={"":i.Clockwise,"'":i.CounterClockwise};function st(t){let e,s=[];for(;e=tt.exec(t);){const t=e[1],i=e[2];s.push({unit:t,turnType:et[i],slices:1})}return s}function it(t,e){return new Array(t).fill(e)}class SkewbSimulator extends Simulator{constructor(){super();const{stickerIds:t}=this.addFace(it(5,"top"),"top"),{stickerIds:e}=this.addFace(it(5,"front"),"front"),{stickerIds:s}=this.addFace(it(5,"right"),"right"),{stickerIds:i}=this.addFace(it(5,"bottom"),"bottom"),{stickerIds:r}=this.addFace(it(5,"back"),"back"),{stickerIds:o}=this.addFace(it(5,"left"),"left");this.addTurn([[s[0],r[0]],[s[2],r[4]],[s[3],r[1]],[s[4],r[3]],[r[0],i[0]],[r[4],i[2]],[r[1],i[3]],[r[3],i[4]],[i[0],s[0]],[i[2],s[2]],[i[3],s[3]],[i[4],s[4]],[e[4],t[2]],[t[2],o[3]],[o[3],e[4]]],"R"),this.addTurn([[rt(t),rt(o)],[ot(t),ot(o)],[at(t),at(o)],[nt(t),nt(o)],[rt(o),rt(r)],[ot(o),at(r)],[at(o),ht(r)],[nt(o),ot(r)],[rt(r),rt(t)],[at(r),ot(t)],[ht(r),at(t)],[ot(r),nt(t)],[at(s),ot(e)],[ot(e),nt(i)],[nt(i),at(s)]],"U"),this.addTurn([[rt(o),rt(e)],[nt(o),ot(e)],[at(o),ht(e)],[ht(o),nt(e)],[rt(e),rt(i)],[ot(e),at(i)],[ht(e),nt(i)],[nt(e),ot(i)],[rt(i),rt(o)],[at(i),nt(o)],[nt(i),at(o)],[ot(i),ht(o)],[ht(r),nt(t)],[nt(t),nt(s)],[nt(s),ht(r)]],"L"),this.addTurn([[rt(r),rt(o)],[at(r),ht(o)],[nt(r),ot(o)],[ht(r),nt(o)],[rt(o),rt(i)],[ht(o),ht(i)],[ot(o),ot(i)],[nt(o),nt(i)],[rt(i),rt(r)],[ht(i),at(r)],[ot(i),nt(r)],[nt(i),ht(r)],[ot(t),nt(e)],[nt(e),ht(s)],[ht(s),ot(t)]],"B")}R(t){this.doTurn("R",t)}U(t){this.doTurn("U",t)}L(t){this.doTurn("L",t)}B(t){this.doTurn("B",t)}alg(t){t&&this.doTurns(st(t))}case(t){if(!t)return;let e=st(t).reverse().map((t=>Object.assign(Object.assign({},t),{turnType:t.turnType===i.Clockwise?i.CounterClockwise:i.Clockwise})));this.doTurns(e)}doTurns(t){t.forEach((t=>{let e=t.turnType===i.CounterClockwise;switch(t.unit){case"R":this.R(e);break;case"U":this.U(e);break;case"L":this.L(e);break;case"B":this.B(e)}}))}}const rt=t=>t[0],ot=t=>t[1],at=t=>t[2],nt=t=>t[3],ht=t=>t[4],ct=/([LlRrUuBb])(\'?)/g,lt={"":i.Clockwise,"'":i.CounterClockwise};function ut(t){let e,s=[];for(;e=ct.exec(t);){const t=e[1],i=e[2];s.push({unit:t,turnType:lt[i],slices:1})}return s}class PyraminxSimulator extends Simulator{constructor(){super();const{stickerIds:t}=this.addFace(it(9,"top"),"top"),{stickerIds:e}=this.addFace(it(9,"left"),"left"),{stickerIds:s}=this.addFace(it(9,"right"),"right"),{stickerIds:i}=this.addFace(it(9,"back"),"back");this.addTurn([[t[8],s[8]],[s[8],e[8]],[e[8],t[8]]],"u"),this.addTurn([[e[0],i[8]],[i[8],t[4]],[t[4],e[0]]],"l"),this.addTurn([[e[4],s[0]],[s[0],i[4]],[i[4],e[4]]],"r"),this.addTurn([[s[4],t[0]],[t[0],i[0]],[i[0],s[4]]],"b"),this.addTurn([[t[5],s[5]],[t[6],s[6]],[t[7],s[7]],[t[8],s[8]],[s[5],e[5]],[s[6],e[6]],[s[7],e[7]],[s[8],e[8]],[e[5],t[5]],[e[6],t[6]],[e[7],t[7]],[e[8],t[8]]],"U"),this.addTurn([[e[0],i[8]],[e[1],i[6]],[e[2],i[5]],[e[5],i[7]],[i[8],t[4]],[i[6],t[3]],[i[5],t[7]],[i[7],t[2]],[t[4],e[0]],[t[3],e[1]],[t[7],e[2]],[t[2],e[5]]],"L"),this.addTurn([[e[2],s[5]],[e[3],s[1]],[e[4],s[0]],[e[7],s[2]],[s[5],i[2]],[s[1],i[3]],[s[0],i[4]],[s[2],i[7]],[i[2],e[2]],[i[3],e[3]],[i[4],e[4]],[i[7],e[7]]],"R"),this.addTurn([[s[2],t[5]],[s[3],t[1]],[s[4],t[0]],[s[7],t[2]],[t[5],i[5]],[t[1],i[1]],[t[0],i[0]],[t[2],i[2]],[i[5],s[2]],[i[1],s[3]],[i[0],s[4]],[i[2],s[7]]],"B")}U(t){this.doTurn("U",t)}R(t){this.doTurn("R",t)}L(t){this.doTurn("L",t)}B(t){this.doTurn("B",t)}u(t){this.doTurn("u",t)}r(t){this.doTurn("r",t)}l(t){this.doTurn("l",t)}b(t){this.doTurn("b",t)}alg(t){t&&this.doTurns(ut(t))}case(t){if(!t)return;let e=ut(t).reverse().map((t=>Object.assign(Object.assign({},t),{turnType:t.turnType===i.Clockwise?i.CounterClockwise:i.Clockwise})));this.doTurns(e)}doTurns(t){t.forEach((t=>{let e=t.turnType===i.CounterClockwise;switch(t.unit){case"R":this.R(e);break;case"r":this.r(e);break;case"U":this.U(e);break;case"u":this.u(e);break;case"L":this.L(e);break;case"l":this.l(e);break;case"B":this.B(e);break;case"b":this.b(e)}}))}}const dt=["U","R","F","dr","dl","L","d","br","BR","BL","bl","b"],ft=/([RD])([\+\+|\-\-]+)|([UFRL]|BR|BL)([2-3]?)(\'?)/g;var bt;!function(t){t.Clockwise="++",t.CounterClockwise="--",t.FaceClockwise="",t.FaceCounter="'"}(bt||(bt={}));const pt={[bt.Clockwise]:i.Clockwise,[bt.CounterClockwise]:i.CounterClockwise,[bt.FaceClockwise]:i.Clockwise,[bt.FaceCounter]:i.CounterClockwise};function mt(t){if(!t)return[];let e,s=[];for(;e=ft.exec(t);){const t=e[1]?`${e[1]}xx`:e[3],i=e[2]||e[5],r=e[4];s.push({unit:t,turnType:pt[i],slices:1,n:r?parseInt(r):1})}return s}class MegaminxSimulator extends Simulator{constructor(){super(),dt.forEach((t=>{this.addFace(it(11,t),t)}));const t=this.faces.get("U"),e=this.faces.get("R"),s=this.faces.get("F"),i=this.faces.get("dr"),r=this.faces.get("dl"),o=this.faces.get("L"),a=this.faces.get("d"),n=this.faces.get("br"),h=this.faces.get("BR"),c=this.faces.get("BL"),l=this.faces.get("bl"),u=this.faces.get("b");this.addTurn([[s[2],t[6]],[s[1],t[5]],[s[10],t[4]],[t[6],h[10]],[t[5],h[9]],[t[4],h[8]],[h[10],n[8]],[h[9],n[7]],[h[8],n[6]],[n[8],i[2]],[n[7],i[1]],[n[6],i[10]],[i[2],s[2]],[i[1],s[1]],[i[10],s[10]],...gt(e)],"R"),this.addTurn([[t[2],e[2]],[t[3],e[3]],[t[4],e[4]],[e[2],i[2]],[e[3],i[3]],[e[4],i[4]],[i[2],r[2]],[i[3],r[3]],[i[4],r[4]],[r[2],o[2]],[r[3],o[3]],[r[4],o[4]],[o[2],t[2]],[o[3],t[3]],[o[4],t[4]],...gt(s)],"F"),this.addTurn([[s[2],o[4]],[s[3],o[5]],[s[4],o[6]],[o[4],c[8]],[o[5],c[9]],[o[6],c[10]],[c[8],h[6]],[c[9],h[7]],[c[10],h[8]],[h[6],e[10]],[h[7],e[1]],[h[8],e[2]],[e[10],s[2]],[e[1],s[3]],[e[2],s[4]],...gt(t)],"U"),this.addTurn([[s[4],r[4]],[s[5],r[5]],[s[6],r[6]],[r[4],l[8]],[r[5],l[9]],[r[6],l[10]],[l[8],c[6]],[l[9],c[7]],[l[10],c[8]],[c[6],t[10]],[c[7],t[1]],[c[8],t[2]],[t[10],s[4]],[t[1],s[5]],[t[2],s[6]],...gt(o)],"L"),this.addTurn([[t[6],c[10]],[t[7],c[1]],[t[8],c[2]],[c[10],u[8]],[c[1],u[9]],[c[2],u[10]],[u[8],n[4]],[u[9],n[5]],[u[10],n[6]],[n[4],e[8]],[n[5],e[9]],[n[6],e[10]],[e[8],t[6]],[e[9],t[7]],[e[10],t[8]],...gt(h)],"BR"),this.addTurn([[t[8],o[6]],[t[9],o[7]],[t[10],o[8]],[o[6],l[10]],[o[7],l[1]],[o[8],l[2]],[l[10],u[6]],[l[1],u[7]],[l[2],u[8]],[u[6],h[4]],[u[7],h[5]],[u[8],h[6]],[h[4],t[8]],[h[5],t[9]],[h[6],t[10]],...gt(c)],"BL"),this.addTurn([[s[8],e[4]],[s[9],e[5]],[s[10],e[6]],[e[4],n[8]],[e[5],n[9]],[e[6],n[10]],[n[8],a[6]],[n[9],a[7]],[n[10],a[8]],[a[6],r[10]],[a[7],r[1]],[a[8],r[2]],[r[10],s[8]],[r[1],s[9]],[r[2],s[10]],...gt(i)],"dr"),this.addTurn([[s[6],i[4]],[s[7],i[5]],[s[8],i[6]],[i[4],a[8]],[i[5],a[9]],[i[6],a[10]],[a[8],l[6]],[a[9],l[7]],[a[10],l[8]],[l[6],o[10]],[l[7],o[1]],[l[8],o[2]],[o[10],s[6]],[o[1],s[7]],[o[2],s[8]],...gt(r)],"dl"),this.addTurn([[n[10],u[2]],[n[1],u[3]],[n[2],u[4]],[u[2],l[4]],[u[3],l[5]],[u[4],l[6]],[l[4],r[8]],[l[5],r[9]],[l[6],r[10]],[r[8],i[6]],[r[9],i[7]],[r[10],i[8]],[i[6],n[10]],[i[7],n[1]],[i[8],n[2]],...gt(a)],"d"),this.addTurn([[u[10],a[4]],[u[1],a[5]],[u[2],a[6]],[a[4],i[8]],[a[5],i[9]],[a[6],i[10]],[i[8],e[6]],[i[9],e[7]],[i[10],e[8]],[e[6],h[10]],[e[7],h[1]],[e[8],h[2]],[h[10],u[10]],[h[1],u[1]],[h[2],u[2]],...gt(n)],"br"),this.addTurn([[c[4],o[8]],[c[5],o[9]],[c[6],o[10]],[o[8],r[6]],[o[9],r[7]],[o[10],r[8]],[r[6],a[10]],[r[7],a[1]],[r[8],a[2]],[a[10],u[4]],[a[1],u[5]],[a[2],u[6]],[u[4],c[4]],[u[5],c[5]],[u[6],c[6]],...gt(l)],"bl"),this.addTurn([[n[2],h[2]],[n[3],h[3]],[n[4],h[4]],[h[2],c[2]],[h[3],c[3]],[h[4],c[4]],[c[2],l[2]],[c[3],l[3]],[c[4],l[4]],[l[2],a[2]],[l[3],a[3]],[l[4],a[4]],[a[2],n[2]],[a[3],n[3]],[a[4],n[4]],...gt(u)],"b"),this.addTurn([[s[0],e[0]],[s[1],e[9]],[s[5],e[3]],[s[6],e[4]],[s[7],e[5]],[s[8],e[6]],[s[9],e[7]],[s[10],e[8]],[e[0],h[0]],[e[3],h[9]],[e[4],h[10]],[e[5],h[1]],[e[6],h[2]],[e[7],h[3]],[e[8],h[4]],[e[9],h[5]],[h[0],c[0]],[h[9],c[1]],[h[10],c[2]],[h[1],c[3]],[h[2],c[4]],[h[3],c[5]],[h[4],c[6]],[h[5],c[7]],[c[0],o[0]],[c[1],o[7]],[c[2],o[8]],[c[3],o[9]],[c[4],o[10]],[c[5],o[1]],[c[6],o[2]],[c[7],o[3]],[o[0],s[0]],[o[7],s[5]],[o[8],s[6]],[o[9],s[7]],[o[10],s[8]],[o[1],s[9]],[o[2],s[10]],[o[3],s[1]],[i[0],n[0]],[i[1],n[5]],[i[2],n[6]],[i[3],n[7]],[i[4],n[8]],[i[5],n[9]],[i[6],n[10]],[i[7],n[1]],[i[8],n[2]],[i[9],n[3]],[i[10],n[4]],[n[0],u[0]],[n[1],u[3]],[n[2],u[4]],[n[3],u[5]],[n[4],u[6]],[n[5],u[7]],[n[6],u[8]],[n[7],u[9]],[n[8],u[10]],[n[9],u[1]],[n[10],u[2]],[u[0],l[0]],[u[1],l[3]],[u[2],l[4]],[u[3],l[5]],[u[4],l[6]],[u[5],l[7]],[u[6],l[8]],[u[7],l[9]],[u[8],l[10]],[u[9],l[1]],[u[10],l[2]],[l[0],r[0]],[l[1],r[5]],[l[2],r[6]],[l[3],r[7]],[l[4],r[8]],[l[5],r[9]],[l[6],r[10]],[l[7],r[1]],[l[8],r[2]],[l[9],r[3]],[l[10],r[4]],[r[0],i[0]],[r[1],i[9]],[r[2],i[10]],[r[3],i[1]],[r[4],i[2]],[r[5],i[3]],[r[6],i[4]],[r[7],i[5]],[r[8],i[6]],[r[9],i[7]],[r[10],i[8]],...gt(a)],"D++"),this.addTurn([[s[0],t[0]],[s[7],t[3]],[s[8],t[4]],[s[9],t[5]],[s[10],t[6]],[s[1],t[7]],[s[2],t[8]],[s[3],t[9]],[t[0],c[0]],[t[3],c[9]],[t[4],c[10]],[t[5],c[1]],[t[6],c[2]],[t[7],c[3]],[t[8],c[4]],[t[9],c[5]],[c[0],l[0]],[c[9],l[1]],[c[10],l[2]],[c[1],l[3]],[c[2],l[4]],[c[3],l[5]],[c[4],l[6]],[c[5],l[7]],[l[0],r[0]],[l[1],r[7]],[l[2],r[8]],[l[3],r[9]],[l[4],r[10]],[l[5],r[1]],[l[6],r[2]],[l[7],r[3]],[r[0],s[0]],[r[7],s[7]],[r[8],s[8]],[r[9],s[9]],[r[10],s[10]],[r[1],s[1]],[r[2],s[2]],[r[3],s[3]],[i[0],e[0]],[i[1],e[9]],[i[2],e[10]],[i[3],e[1]],[i[4],e[2]],[i[5],e[3]],[i[6],e[4]],[i[7],e[5]],[i[8],e[6]],[i[9],e[7]],[i[10],e[8]],[e[0],h[0]],[e[1],h[5]],[e[2],h[6]],[e[3],h[7]],[e[4],h[8]],[e[5],h[9]],[e[6],h[10]],[e[7],h[1]],[e[8],h[2]],[e[9],h[3]],[e[10],h[4]],[h[0],u[0]],[h[1],u[1]],[h[2],u[2]],[h[3],u[3]],[h[4],u[4]],[h[5],u[5]],[h[6],u[6]],[h[7],u[7]],[h[8],u[8]],[h[9],u[9]],[h[10],u[10]],[u[0],a[0]],[u[1],a[5]],[u[2],a[6]],[u[3],a[7]],[u[4],a[8]],[u[5],a[9]],[u[6],a[10]],[u[7],a[1]],[u[8],a[2]],[u[9],a[3]],[u[10],a[4]],[a[0],i[0]],[a[1],i[5]],[a[2],i[6]],[a[3],i[7]],[a[4],i[8]],[a[5],i[9]],[a[6],i[10]],[a[7],i[1]],[a[8],i[2]],[a[9],i[3]],[a[10],i[4]],...gt(n)],"R++")}U(t){this.doTurn("U",t)}R(t){this.doTurn("R",t)}F(t){this.doTurn("F",t)}dr(t){this.doTurn("dr",t)}dl(t){this.doTurn("dl",t)}L(t){this.doTurn("L",t)}d(t){this.doTurn("d",t)}br(t){this.doTurn("br",t)}BR(t){this.doTurn("BR",t)}BL(t){this.doTurn("BL",t)}bl(t){this.doTurn("bl",t)}b(t){this.doTurn("b",t)}Dxx(t){this.doTurn("D++",t)}Rxx(t){this.doTurn("R++",t)}alg(t){t&&this.doTurns(mt(t))}case(t){if(!t)return;let e=mt(t).reverse().map((t=>Object.assign(Object.assign({},t),{turnType:t.turnType===i.Clockwise?i.CounterClockwise:i.Clockwise})));this.doTurns(e)}doTurns(t){t.forEach((t=>{let e,s=t.turnType===i.CounterClockwise;switch(t.unit){case"Rxx":e=this.Rxx.bind(this);break;case"Dxx":e=this.Dxx.bind(this);break;case"U":e=this.U.bind(this);break;case"R":e=this.R.bind(this);break;case"F":e=this.F.bind(this);break;case"L":e=this.L.bind(this);break;case"BL":e=this.BL.bind(this);break;case"BR":e=this.BR.bind(this)}for(let i=t.n;i>0;i--)e(s)}))}}function gt(t){return[[t[1],t[9]],[t[9],t[7]],[t[7],t[5]],[t[5],t[3]],[t[3],t[1]],[t[2],t[10]],[t[10],t[8]],[t[8],t[6]],[t[6],t[4]],[t[4],t[2]]]}var wt;!function(t){t.U="U",t.R="R",t.F="F",t.D="D",t.L="L",t.B="B"}(wt||(wt={}));const kt=[wt.U,wt.R,wt.F,wt.D,wt.L,wt.B];var St;!function(t){t.X="X",t.Y="Y",t.Z="Z"}(St||(St={}));const yt={X:[wt.U,wt.B,wt.D,wt.F],Y:[wt.L,wt.B,wt.R,wt.F],Z:[wt.L,wt.U,wt.R,wt.D]},Ct={X:{[wt.U]:0,[wt.B]:2,[wt.F]:0,[wt.D]:0},Y:{[wt.B]:-1,[wt.F]:-1,[wt.L]:-1,[wt.R]:-1},Z:{[wt.U]:-1,[wt.D]:1,[wt.L]:2,[wt.R]:0}},Ft={[wt.U]:!1,[wt.R]:!1,[wt.F]:!1,[wt.D]:!0,[wt.L]:!0,[wt.B]:!0};var Et=1e-6,Rt="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function vt(){var t=new Rt(3);return Rt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Lt(t){var e=new Rt(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Mt(t,e,s){var i=new Rt(3);return i[0]=t,i[1]=e,i[2]=s,i}function Pt(t,e,s){return t[0]=e[0]*s[0],t[1]=e[1]*s[1],t[2]=e[2]*s[2],t}function Bt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Tt(t,e,s){var i=e[0],r=e[1],o=e[2],a=s[0],n=s[1],h=s[2];return t[0]=r*h-o*n,t[1]=o*a-i*h,t[2]=i*n-r*a,t}function It(t,e,s,i){var r=[],o=[];return r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+s[0],t[1]=o[1]+s[1],t[2]=o[2]+s[2],t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var xt,Nt=function(t){var e=t[0],s=t[1],i=t[2];return Math.hypot(e,s,i)};xt=vt();function Dt(t){return Math.PI*t/180}function Ut(t,e){return[t*Math.cos(e),t*Math.sin(e)]}function Gt(t){return t/2*Math.sqrt(2.5+1.1*Math.sqrt(5))}function zt(t){let e=0,s=0,i=0;return t.forEach((t=>{e+=t[0],s+=t[1],i+=t[2]})),e/=t.length,s/=t.length,i/=t.length,Lt([e,s,i])}class RubiksCubeSimulator extends Simulator{constructor(t){super(),this.size=t,this.gridSize=t*t,kt.forEach((t=>{this.addFace(it(this.gridSize,t),t);const e=this.makeFaceTurnDefinitions(t);this.addTurn(e,t)})),[St.X,St.Y,St.Z].forEach((t=>{for(let e=0;e<this.size;e++){let s=[];yt[t].forEach(((i,r)=>{const o=yt[t][(r+1)%yt[t].length],a=this.faces.get(o),n=this.faces.get(i);for(let r=0;r<this.size;r++){const h=this.size*r+e,c=n[this.axisAlignedSticker(t,i,h)],l=a[this.axisAlignedSticker(t,o,h)];s.push([c,l])}})),this.addTurn(s,`${t}-${e}`)}}))}makeFaceTurnDefinitions(t){const e=this.faces.get(t);return e.map(((t,s)=>[t,e[this.clockwiseSticker(s)]]))}clockwiseSticker(t){return(t+1)*this.size%(this.gridSize+1)-1}counterClockwiseSticker(t){return this.oppositeSticker(this.clockwiseSticker(t))}oppositeSticker(t){return this.gridSize-(t+1)}axisAlignedSticker(t,e,s){switch(Ct[t][e]){case 0:return s;case 1:return this.clockwiseSticker(s);case 2:return this.oppositeSticker(s);case-1:return this.counterClockwiseSticker(s);default:throw`Invalid axis face orientation value ${Ct[t][e]}`}}turnFace(t,e,s,i,r){Math.abs(r-i)>=this.size-1?console.error(`Invalid number of layers to turn, skipping turn.; face=${t}, layers=${Math.abs(r-i)+1}`):(this.doTurn(t,s),function(t,e){if(t===e)return[t];const s=t<e?1:-1;let i=[];for(let r=t;r!=e;r+=s)i.push(r);return i.push(e),i}(i,r).forEach((i=>{this.doTurn(`${e}-${i}`,Ft[t]?!s:s)})))}U(t=!1,e=1){this.turnFace(wt.U,St.Y,t,this.size-1,this.size-e)}R(t=!1,e=1){this.turnFace(wt.R,St.X,t,this.size-1,this.size-e)}F(t=!1,e=1){this.turnFace(wt.F,St.Z,t,0,e-1)}D(t=!1,e=1){this.turnFace(wt.D,St.Y,t,0,e-1)}L(t=!1,e=1){this.turnFace(wt.L,St.X,t,0,e-1)}B(t=!1,e=1){this.turnFace(wt.B,St.Z,t,this.size-1,this.size-e)}M(t=!1){for(let e=1;e<this.size-1;e++)this.doTurn(`${St.X}-${e}`,!t)}S(t=!1){for(let e=1;e<this.size-1;e++)this.doTurn(`${St.Z}-${e}`,t)}E(t=!1){for(let e=1;e<this.size-1;e++)this.doTurn(`${St.Y}-${e}`,!t)}X(t=!1){this.doTurn("R",t),this.doTurn("L",!t);for(let e=0;e<this.size;e++)this.doTurn(`${St.X}-${e}`,t)}Y(t=!1){this.doTurn("U",t),this.doTurn("D",!t);for(let e=0;e<this.size;e++)this.doTurn(`${St.Y}-${e}`,t)}Z(t=!1){this.doTurn("F",t),this.doTurn("B",!t);for(let e=0;e<this.size;e++)this.doTurn(`${St.Z}-${e}`,t)}alg(t){t&&this.doTurns(l(t))}case(t){if(!t)return;let e=l(t).reverse().map((t=>{switch(t.turnType){case i.Clockwise:t.turnType=i.CounterClockwise;break;case i.CounterClockwise:t.turnType=i.Clockwise;break;case i.Double:}return t}));this.doTurns(e)}doTurns(t){t.forEach((t=>{let e;switch(t.unit){case o.U:e=this.U.bind(this);break;case o.R:e=this.R.bind(this);break;case o.F:e=this.F.bind(this);break;case o.D:e=this.D.bind(this);break;case o.L:e=this.L.bind(this);break;case o.B:e=this.B.bind(this);break;case o.M:e=this.M.bind(this);break;case o.E:e=this.E.bind(this);break;case o.S:e=this.S.bind(this);break;case o.X:e=this.X.bind(this);break;case o.Y:e=this.Y.bind(this);break;case o.Z:e=this.Z.bind(this);break;default:console.warn("Unsupported cube move",t)}const s=t.turnType===i.CounterClockwise;e(s,t.slices),t.turnType===i.Double&&e(s,t.slices)}))}}function At(){var t=new Rt(16);return Rt!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Ot(t,e,s){var i,r,o,a,n,h,c,l,u,d,f,b,p=s[0],m=s[1],g=s[2];return e===t?(t[12]=e[0]*p+e[4]*m+e[8]*g+e[12],t[13]=e[1]*p+e[5]*m+e[9]*g+e[13],t[14]=e[2]*p+e[6]*m+e[10]*g+e[14],t[15]=e[3]*p+e[7]*m+e[11]*g+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],n=e[4],h=e[5],c=e[6],l=e[7],u=e[8],d=e[9],f=e[10],b=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=n,t[5]=h,t[6]=c,t[7]=l,t[8]=u,t[9]=d,t[10]=f,t[11]=b,t[12]=i*p+n*m+u*g+e[12],t[13]=r*p+h*m+d*g+e[13],t[14]=o*p+c*m+f*g+e[14],t[15]=a*p+l*m+b*g+e[15]),t}function jt(t,e,s){var i=s[0],r=s[1],o=s[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Wt(t,e,s,i){var r,o,a,n,h,c,l,u,d,f,b,p,m,g,w,k,S,y,C,F,E,R,v,L,M=i[0],P=i[1],B=i[2],T=Math.hypot(M,P,B);return T<Et?null:(M*=T=1/T,P*=T,B*=T,r=Math.sin(s),a=1-(o=Math.cos(s)),n=e[0],h=e[1],c=e[2],l=e[3],u=e[4],d=e[5],f=e[6],b=e[7],p=e[8],m=e[9],g=e[10],w=e[11],k=M*M*a+o,S=P*M*a+B*r,y=B*M*a-P*r,C=M*P*a-B*r,F=P*P*a+o,E=B*P*a+M*r,R=M*B*a+P*r,v=P*B*a-M*r,L=B*B*a+o,t[0]=n*k+u*S+p*y,t[1]=h*k+d*S+m*y,t[2]=c*k+f*S+g*y,t[3]=l*k+b*S+w*y,t[4]=n*C+u*F+p*E,t[5]=h*C+d*F+m*E,t[6]=c*C+f*F+g*E,t[7]=l*C+b*F+w*E,t[8]=n*R+u*v+p*L,t[9]=h*R+d*v+m*L,t[10]=c*R+f*v+g*L,t[11]=l*R+b*v+w*L,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}var $t=function(t,e,s){var i=e[0],r=e[1],o=e[2],a=e[3],n=e[4],h=e[5],c=e[6],l=e[7],u=e[8],d=e[9],f=e[10],b=e[11],p=e[12],m=e[13],g=e[14],w=e[15],k=s[0],S=s[1],y=s[2],C=s[3];return t[0]=k*i+S*n+y*u+C*p,t[1]=k*r+S*h+y*d+C*m,t[2]=k*o+S*c+y*f+C*g,t[3]=k*a+S*l+y*b+C*w,k=s[4],S=s[5],y=s[6],C=s[7],t[4]=k*i+S*n+y*u+C*p,t[5]=k*r+S*h+y*d+C*m,t[6]=k*o+S*c+y*f+C*g,t[7]=k*a+S*l+y*b+C*w,k=s[8],S=s[9],y=s[10],C=s[11],t[8]=k*i+S*n+y*u+C*p,t[9]=k*r+S*h+y*d+C*m,t[10]=k*o+S*c+y*f+C*g,t[11]=k*a+S*l+y*b+C*w,k=s[12],S=s[13],y=s[14],C=s[15],t[12]=k*i+S*n+y*u+C*p,t[13]=k*r+S*h+y*d+C*m,t[14]=k*o+S*c+y*f+C*g,t[15]=k*a+S*l+y*b+C*w,t};const _t=(()=>{let t=0;return function(){return t++}})();class Object3D{constructor(){this.uid=_t(),this.matrix=At(),this.centroid=[0,0,0]}translate(t){Ot(this.matrix,this.matrix,t)}rotate(t,e){Wt(this.matrix,this.matrix,t,e)}scale(t){jt(this.matrix,this.matrix,t)}setColor(t){this.color=t}}class Group extends Object3D{constructor(t=[]){super(),this.setObjects(t)}setObjects(t){this.objects=t}addObject(t){this.objects.push(t)}setCentroid(t){this.centroid=t}}const qt=Math.sqrt(3),Ht=Math.atan(Dt(15)),Xt=Dt(30),Yt=(Dt(36),Dt(60));Dt(72);class Square1Builder{constructor(t=K,e=V,s=!1,i=.7){this.sideLength=i,this.halfSide=this.sideLength/2,this.halfEdgePiece=this.halfSide*Ht,this.layerWidth=this.halfSide-this.halfEdgePiece,this.middleWidth=this.sideLength-2*this.layerWidth,this.halfMiddleWidth=this.middleWidth/2,this.borderLayerWidth=.2*this.sideLength,this.outerHalfSide=(i+this.borderLayerWidth)/2,this.outerHalfEdgePiece=this.outerHalfSide*Ht,this.pieces=this.buildSquare1(t,e,s),this.group=new Group(this.pieces)}makeLayer(t){let e=[],s=Math.PI;return t.forEach(((t,i)=>{switch(t.type){case O.CORNER:const i=this.square1Corner(t.colors[0],t.colors[1],t.colors[2]);i.rotate(s,[0,0,1]),e.push(i),s-=Yt;break;case O.EDGE:const r=this.square1Edge(t.colors[0],t.colors[1]);r.rotate(s-Yt,[0,0,1]),e.push(r),s-=Xt}})),e}setColors(t){}}class Face{constructor(t,e,s){this.indices=t,this.color=s,this.uid=_t(),e&&this.calculateCentroid(e)}calculateCentroid(t){this.centroid=zt(t.filter(((t,e)=>this.indices.includes(e))))}}class Geometry extends Object3D{constructor(t,e){super(),this.vertices=t,this.faces=e,this.centroid=zt(this.vertices)}}class Square1Net extends Square1Builder{square1Corner(t,e,s){const i=[[0,0,0],[this.halfSide,this.halfEdgePiece,0],[this.halfSide,this.halfSide,0],[this.halfEdgePiece,this.halfSide,0],[this.outerHalfSide,this.outerHalfEdgePiece,0],[this.outerHalfSide,this.outerHalfSide,0],[this.outerHalfEdgePiece,this.outerHalfSide,0]],r=[new Face([0,1,2,3],i,t),new Face([2,3,6,5],i,e),new Face([1,2,5,4],i,s)];return new Geometry(i,r)}square1Edge(t,e){const s=[It(vt(),[0,0,0],[0,0,0],Xt),It(vt(),[this.halfEdgePiece,this.halfSide,0],[0,0,0],Xt),It(vt(),[-this.halfEdgePiece,this.halfSide,0],[0,0,0],Xt),It(vt(),[this.outerHalfEdgePiece,this.outerHalfSide,0],[0,0,0],Xt),It(vt(),[-this.outerHalfEdgePiece,this.outerHalfSide,0],[0,0,0],Xt)],i=[new Face([0,1,2],s,t),new Face([1,2,4,3],s,e)];return new Geometry(s,i)}square1Middle(t,e,s,i){const r=this.halfSide-this.halfEdgePiece,o=(this.sideLength-2*r)/2,a=this.outerHalfSide-this.outerHalfEdgePiece,n=[[-this.outerHalfSide,o,-.01],[-this.outerHalfEdgePiece,o,-.01],[this.outerHalfSide,o,-.01],[-this.outerHalfSide,-o,-.01],[-this.outerHalfEdgePiece,-o,-.01],[this.outerHalfSide,-o,-.01],[2*this.outerHalfEdgePiece,o,-.01],[2*this.outerHalfEdgePiece,-o,-.01],[2*a,o,-.01],[2*a,-o,-.01]],h=[new Face([0,1,4,3],n,t)];return i?(h.push(new Face([1,6,7,4],n,s)),h.push(new Face([6,8,9,7],n,e))):h.push(new Face([1,2,5,4],n,t)),new Geometry(n,h)}buildSquare1(t,e,s){const i=this.halfSide-this.halfEdgePiece,r=(this.sideLength-2*i)/2;let o=[];const a=new Group(this.makeLayer(t)),n=new Group(this.makeLayer(e));a.translate([0,this.outerHalfSide+r,0]),n.translate([0,-(this.outerHalfSide+r),0]),n.rotate(Xt,[0,0,1]),o=[a,n];const h=this.square1Middle(_,H,X,s);return this.faces={top:a,bottom:n},o.push(h),o}}class Square1 extends Square1Builder{constructor(t=K,e=V,s=!1,i=1.25){super(t,e,s,i)}square1Corner(t,e,s){const i=[[0,0,this.halfSide],[this.halfSide,this.halfEdgePiece,this.halfSide],[this.halfSide,this.halfSide,this.halfSide],[this.halfEdgePiece,this.halfSide,this.halfSide],[0,0,this.halfSide-this.layerWidth],[this.halfSide,this.halfEdgePiece,this.halfSide-this.layerWidth],[this.halfSide,this.halfSide,this.halfSide-this.layerWidth],[this.halfEdgePiece,this.halfSide,this.halfSide-this.layerWidth]],r=[new Face([0,1,2,3],i,t),new Face([2,3,7,6],i,e),new Face([1,2,6,5],i,s)];return new Geometry(i,r)}square1Edge(t,e){const s=[It(vt(),[0,0,this.halfSide],[0,0,0],Xt),It(vt(),[this.halfEdgePiece,this.halfSide,this.halfSide],[0,0,0],Xt),It(vt(),[-this.halfEdgePiece,this.halfSide,this.halfSide],[0,0,0],Xt),It(vt(),[0,0,this.halfSide-this.layerWidth],[0,0,0],Xt),It(vt(),[this.halfEdgePiece,this.halfSide,this.halfSide-this.layerWidth],[0,0,0],Xt),It(vt(),[-this.halfEdgePiece,this.halfSide,this.halfSide-this.layerWidth],[0,0,0],Xt)],i=[new Face([0,1,2],s,t),new Face([1,2,5,4],s,e)];return new Geometry(s,i)}square1Middle(t,e,s){const i=[[-this.halfSide,-this.halfSide,this.halfMiddleWidth],[-this.halfSide,this.halfSide,this.halfMiddleWidth],[this.halfEdgePiece,this.halfSide,this.halfMiddleWidth],[-this.halfEdgePiece,-this.halfSide,this.halfMiddleWidth],[-this.halfSide,-this.halfSide,-this.halfMiddleWidth],[-this.halfSide,this.halfSide,-this.halfMiddleWidth],[this.halfEdgePiece,this.halfSide,-this.halfMiddleWidth],[-this.halfEdgePiece,-this.halfSide,-this.halfMiddleWidth]],r=[new Face([0,1,2,3],i,{value:"#333"}),new Face([4,5,6,7],i,{value:"#333"}),new Face([0,1,5,4],i,e),new Face([1,2,6,5],i,s),new Face([2,3,7,6],i,{value:"#333"}),new Face([0,3,7,4],i,t)];return new Geometry(i,r)}buildSquare1(t,e,s){const i=new Group(this.makeLayer(t)),r=new Group(this.makeLayer(e));i.translate([0,0,.005]),r.translate([0,0,-.005]),r.rotate(Math.PI,[1,0,0]),r.rotate(Xt,[0,0,1]);const o=[i,r],a=this.square1Middle(_,q,X),n=this.square1Middle(X,H,_);return n.rotate(Math.PI,[0,0,1]),s&&n.rotate(Math.PI,j),o.push(a),o.push(n),this.faces={top:i,bottom:r},o}}class Plane extends Geometry{constructor(t,e,s){let i=[Lt([0,0,0]),Lt([t,0,0]),Lt([t,-e,0]),Lt([0,-e,0])];super(i,[new Face([0,1,2,3],i,s)])}}class Triangle extends Geometry{constructor(t,e,s,i){let r=[t,e,s];super(r,[new Face([0,1,2],r,i)])}}class SkewbNet{constructor(){const t=Math.sqrt(2*Math.pow(.5,2)),e=new Group(this.makeStickers(w,t,[-1,0,0])),s=new Group(this.makeStickers(k,t,[2,0,0])),i=new Group(this.makeStickers(g,t,[0,-1,0])),r=new Group(this.makeStickers(p,t,[1,0,0])),o=new Group(this.makeStickers(b,t,[0,1,0])),a=new Group(this.makeStickers(m,t,[0,0,0]));this.U=o,this.R=r,this.F=a,this.L=e,this.B=s,this.D=i,this.faces={top:this.U,front:this.F,right:this.R,back:this.B,left:this.L,bottom:this.D},this.stickers=[r,o,a,e,s,i],this.group=new Group(this.stickers),this.group.translate([-1/4,0,0]),this.group.scale([.5,.5,.5])}makeStickers(t,e,s){const i=new Plane(e,e,t);i.translate(s),i.rotate(Math.PI/4,[0,0,1]),i.translate([-e/2,e/2,0]);const r=[];for(let i=0;i<4;i++){const o=new Triangle([-e/2,e/2,0],[0,e,0],[e/2,e/2,0],t);o.translate(s),o.rotate(-Math.PI/2*i,[0,0,1]),o.rotate(Math.PI/4,[0,0,1]),r.push(o)}return[i,...r]}setColors(t){let{top:e,right:s,front:i,bottom:r,left:o,back:a}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,s),this.setFaceColors(this.F,i),this.setFaceColors(this.D,r),this.setFaceColors(this.L,o),this.setFaceColors(this.B,a)}setFaceColors(t,e=[]){t.objects[0].faces[0].color=e[0]||v,t.objects[1].faces[0].color=e[1]||v,t.objects[2].faces[0].color=e[2]||v,t.objects[3].faces[0].color=e[4]||v,t.objects[4].faces[0].color=e[3]||v}}class Skewb{constructor(){const t=Math.sqrt(2*Math.pow(.625,2)),e=.625,s=new Group(this.makeStickers(p,t)),i=new Group(this.makeStickers(b,t,[1,0,0])),r=new Group(this.makeStickers(m,t,[0,1,0])),o=new Group(this.makeStickers(w,t)),a=new Group(this.makeStickers(k,t,[0,1,0])),n=new Group(this.makeStickers(g,t,[1,0,0]));this.U=i,this.R=s,this.F=r,this.L=o,this.B=a,this.D=n,this.faces={top:this.U,front:this.F,right:this.R,back:this.B,left:this.L,bottom:this.D},s.translate([0,0,e]),s.rotate(Math.PI,[1,0,0]),s.rotate(Math.PI/2,[0,0,1]),o.rotate(-Math.PI/2,[0,0,1]),o.translate([0,0,-.625]),r.rotate(-Math.PI/2,[1,0,0]),r.translate([-.625,0,0]),a.translate([e,0,0]),a.rotate(Math.PI,[0,1,0]),a.rotate(-Math.PI/2,[1,0,0]),i.rotate(Math.PI,[0,1,0]),i.translate([0,e,0]),n.translate([0,-.625,0]),n.rotate(Math.PI,[1,0,0]),this.stickers=[s,i,r,o,a,n],this.group=new Group(this.stickers)}makeStickers(t,e,s){const i=new Plane(e,e,t);s&&i.rotate(Math.PI/2,s),i.rotate(Math.PI/4,[0,0,1]),i.translate([-e/2,e/2,0]);const r=[];for(let i=0;i<4;i++){const o=new Triangle([-e/2,e/2,0],[0,e,0],[e/2,e/2,0],t);s&&o.rotate(Math.PI/2,s),o.rotate(Math.PI/2*i,[0,0,1]),o.rotate(Math.PI/4,[0,0,1]),r.push(o)}return[i,...r]}setColors(t){let{top:e,right:s,front:i,bottom:r,left:o,back:a}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,s),this.setFaceColors(this.F,i),this.setFaceColors(this.D,r),this.setFaceColors(this.L,o),this.setFaceColors(this.B,a)}setFaceColors(t,e=[]){t.objects[0].faces[0].color=e[0]||v,t.objects[1].faces[0].color=e[1]||v,t.objects[2].faces[0].color=e[2]||v,t.objects[3].faces[0].color=e[4]||v,t.objects[4].faces[0].color=e[3]||v}}class TriangleLattice extends Geometry{constructor(t,e,s){const i=t/2,r=t*(qt/2),o=t/e,a=r/e,n=r/3;let h=[],c=[],l=0;for(let t=0;t<=e;t++)for(let r=0,u=e-t;r<=u;r++){const e=o*r+t*o/2+-i,d=a*t+-n;h.push([e,d,0]),t>0&&(r>0&&c.push(new Face([l,l-1,l-u-2],null,s)),c.push(new Face([l,l-u-2,l-u-1],null,s))),l++}c.forEach((t=>t.calculateCentroid(h))),super(h,c)}}const Kt=60*Math.PI/180;class PyraminxNet{constructor(t,e=.925){this.size=t;const s=e*(qt/2)/1.5,i=.1*s,r=new TriangleLattice(e,t,b),o=new TriangleLattice(e,t,k),a=new TriangleLattice(e,t,m),n=new TriangleLattice(e,t,p);this.L=a,this.R=o,this.U=r,this.B=n,o.rotate(-Kt,[0,0,1]),o.translate([0,s+i,0]),o.rotate(2*Kt,[0,0,1]),r.rotate(Kt,[0,0,1]),r.translate([0,s+i,0]),r.rotate(-2*Kt,[0,0,1]),n.rotate(3*Kt,[0,0,1]),n.translate([0,s+i,0]),n.rotate(-2*Kt,[0,0,1]),this.faces={top:this.U,right:this.R,left:this.L,back:this.B},this.group=new Group([r,o,a,n])}setColors(t){let{left:e,right:s,top:i,back:r}=t;this.setFaceColors(this.L,e),this.setFaceColors(this.R,s),this.setFaceColors(this.U,i),this.setFaceColors(this.B,r)}setFaceColors(t,e){t.faces.forEach(((t,s)=>{e&&e[s]?t.color=e[s]:t.color=v}))}}const Vt=Math.acos(1/3),Zt=120*Math.PI/180,Qt=Math.sqrt(24);class Pyraminx{constructor(t,e=1.75){this.size=t;const s=e/Qt,i=new TriangleLattice(e,t,b),r=new TriangleLattice(e,t,k),o=new TriangleLattice(e,t,m),a=new TriangleLattice(e,t,p);this.L=o,this.R=r,this.U=i,this.B=a,i.rotate(Zt,[0,0,1]),i.rotate(Vt,[1,0,0]),i.translate([0,0,s]),r.rotate(Vt,[1,0,0]),r.translate([0,0,s]),o.rotate(-Zt,[0,0,1]),o.rotate(Vt,[1,0,0]),o.translate([0,0,s]),a.rotate(Math.PI,[0,1,0]),a.translate([0,0,s]),this.faces={top:this.U,right:this.R,left:this.L,back:this.B},this.group=new Group([i,o,r,a])}setColors(t){let{left:e,right:s,top:i,back:r}=t;this.setFaceColors(this.L,e),this.setFaceColors(this.R,s),this.setFaceColors(this.U,i),this.setFaceColors(this.B,r)}setFaceColors(t,e){t.faces.forEach(((t,s)=>{e&&e[s]?t.color=e[s]:t.color=v}))}}class DividedPentagon extends Geometry{constructor(t,e=2,s=1.6,i=.4){const r=function(t){return t/(2*Math.sin(Math.PI/5))}(s),o=function(t){const e=t*t,s=71*Math.PI/180,i=2*e-2*e*Math.cos(s);return 2*Math.sqrt(Math.abs(e-i))}(i),a=function(t,e,s,i){let r=[];for(let o=0;o<t;o++){const t=e+s*o;r=[...r,...se(o,t,i)]}return r}(e,r-o*(e-1),o,i);super(a,function(t,e,s){let i=[];const r=new Face([0,1,2,3,4],s,e);i.push(r);let o=5,a=5;for(let r=1;r<t;r++){const t=5+10*r;o+=t;const n=Jt(r),h=te(r-1),c=te(r);for(;a<o;){const r=a-(h[h.length-1]+1);if(r%(t/5)==0){a++;continue}const o=(r+1)%(t/5)==0;let l=a,u=c[(r+1)%c.length],d=o?u+1:n.shift(),f=o?n.shift():h[(h.indexOf(d)-1+h.length)%h.length];a++,i.push(new Face([l,u,d,f],s,e))}}return i}(e,t,a))}}function Jt(t){if(t<1)return[];let e=[];const s=5+10*(t-1);let i=5*(t-1)*(t-1);for(let t=0;t<s;t++)e.push(t+i),t%(s/5)==0&&e.push(t+i);return e.push(e.shift()),e.push(e.shift()),e}function te(t){let e=5*t*t,s=[];for(let i=0,r=5+10*t;i<r;i++)s.push(i+e);return s}function ee(t,e,s,i){if(0===s)return[[t[0],t[1],0],[e[0],e[1],0]];const r=function(t,e){return Math.sqrt(Math.pow(e[1]-t[1],2)+Math.pow(e[0]-t[0],2))}(t,e);let o=[];for(let a=s;a>0;a--){let s=[t[0]+(e[0]-t[0])/r*i*a,t[1]+(e[1]-t[1])/r*i*a,0];o.unshift(s);let n=[e[0]+(t[0]-e[0])/r*i*a,e[1]+(t[1]-e[1])/r*i*a,0];o.push(n)}return o.unshift([t[0],t[1],0]),o.push([e[0],e[1],0]),o}function se(t,e,s){let i=[];for(let r=0;r<5;r++){const o=Ut(e,r*(2*Math.PI)/5-Math.PI/10);if(i.length>0){const e=i[i.length-1],r=ee([e[0],e[1]],o,t,s);r.shift(),i=i.concat(r)}else i.push([o[0],o[1],0])}const r=i[0],o=i[i.length-1],a=ee([o[0],o[1]],[r[0],r[1]],t,s);return a.pop(),a.shift(),i=i.concat(a),i}const ie=36*Math.PI/180,re=72*Math.PI/180,oe={2:.3,3:.17,4:.121};class MegaminxNet{constructor(t){this.layers=t;const e=.75,s=function(t,e){return oe[e]||t/(1.9*e)}(length,t);this.U=new DividedPentagon(g,t,e,s),this.F=new DividedPentagon(p,t,e,s),this.R=new DividedPentagon(m,t,e,s),this.L=new DividedPentagon(k,t,e,s),this.dl=new DividedPentagon(F,t,e,s),this.dr=new DividedPentagon(R,t,e,s),this.BL=new DividedPentagon(S,t,e,s),this.BR=new DividedPentagon(b,t,e,s),this.d=new DividedPentagon(y,t,e,s),this.bl=new DividedPentagon(C,t,e,s),this.br=new DividedPentagon(E,t,e,s),this.b=new DividedPentagon(w,t,e,s);const i=2*function(t){return t/(2*Math.tan(Math.PI/5))}(e);this.U.translate([0,i,0]),this.U.rotate(5*ie,[0,0,1]),this.R.rotate(-re,[0,0,1]),this.R.translate([0,i,0]),this.R.rotate(5*ie,[0,0,1]),this.L.rotate(re,[0,0,1]),this.L.translate([0,i,0]),this.L.rotate(-5*ie,[0,0,1]),this.dl.rotate(2*re,[0,0,1]),this.dl.translate([0,i,0]),this.dl.rotate(-5*ie,[0,0,1]),this.dr.rotate(-2*re,[0,0,1]),this.dr.translate([0,i,0]),this.dr.rotate(-5*ie,[0,0,1]),this.b.rotate(Math.PI,[0,0,1]),this.b.rotate(-2*ie,[0,0,1]),this.d.rotate(3*ie,[0,0,1]),this.d.translate([0,i,0]),this.d.rotate(5*ie,[0,0,1]),this.br.rotate(ie,[0,0,1]),this.br.translate([0,i,0]),this.br.rotate(5*ie,[0,0,1]),this.BR.rotate(-ie,[0,0,1]),this.BR.translate([0,i,0]),this.BR.rotate(-5*ie,[0,0,1]),this.BL.rotate(-3*ie,[0,0,1]),this.BL.translate([0,i,0]),this.BL.rotate(5*ie,[0,0,1]),this.bl.rotate(5*ie,[0,0,1]),this.bl.translate([0,i,0]),this.bl.rotate(-5*ie,[0,0,1]);let r=At();Wt(r,r,-re,[0,0,1]),Ot(r,r,[0,2*i,0]),Wt(r,r,2*re,[0,0,1]),Ot(r,r,[0,-i,0]),[this.d,this.bl,this.BL,this.BR,this.br,this.b].forEach((t=>{$t(t.matrix,r,t.matrix)})),this.faces={U:this.U,F:this.F,R:this.R,dr:this.dr,dl:this.dl,L:this.L,d:this.d,br:this.br,BR:this.BR,BL:this.BL,bl:this.bl,b:this.b},this.group=new Group([this.U,this.F,this.L,this.dr,this.dl,this.R,this.d,this.bl,this.BL,this.BR,this.br,this.b]),this.group.scale([.33,.33,.33]),this.group.translate([-1.3125,0,0])}setColors(t){let{U:e,R:s,F:i,d:r,L:o,b:a,dr:n,dl:h,br:c,BR:l,BL:u,bl:d}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,s),this.setFaceColors(this.F,i),this.setFaceColors(this.d,r),this.setFaceColors(this.L,o),this.setFaceColors(this.b,a),this.setFaceColors(this.dr,n),this.setFaceColors(this.dl,h),this.setFaceColors(this.BR,l),this.setFaceColors(this.BL,u),this.setFaceColors(this.bl,d),this.setFaceColors(this.br,c)}oldSetColors(t){const e=this.layers,s=5*e*e-5*e+1;let[i,r,o,a,n,h,c,l,u,d,f,b]=function(t,e){const s=Math.ceil(t.length/e);return new Array(s).fill(null).map(((s,i)=>t.slice(i*e,(i+1)*e)))}(t,s);this.setFaceColors(this.U,i),this.setFaceColors(this.R,r),this.setFaceColors(this.F,o),this.setFaceColors(this.d,c),this.setFaceColors(this.L,h),this.setFaceColors(this.b,b),this.setFaceColors(this.dr,a),this.setFaceColors(this.dl,n),this.setFaceColors(this.br,l),this.setFaceColors(this.BR,u),this.setFaceColors(this.BL,d),this.setFaceColors(this.bl,f)}setFaceColors(t,e){t.faces.forEach(((t,s)=>{e&&e[s]?t.color=e[s]:t.color=v}))}}const ae={2:.3,3:.17,4:.121};class Megaminx{constructor(t=2){this.layers=t;const e=.75,s=Gt(e),i=function(t,e){return ae[e]||t/(1.9*e)}(e,t);this.U=new DividedPentagon(g,t,e,i),this.F=new DividedPentagon(p,t,e,i),this.R=new DividedPentagon(m,t,e,i),this.dr=new DividedPentagon(R,t,e,i),this.dl=new DividedPentagon(F,t,e,i),this.L=new DividedPentagon(k,t,e,i),this.d=new DividedPentagon(y,t,e,i),this.br=new DividedPentagon(E,t,e,i),this.BR=new DividedPentagon(b,t,e,i),this.BL=new DividedPentagon(S,t,e,i),this.bl=new DividedPentagon(C,t,e,i),this.b=new DividedPentagon(w,t,e,i),this.F.translate([0,0,s]),this.b.rotate(Math.PI,[0,0,1]),this.b.rotate(Math.PI,[0,1,0]),this.b.translate([0,0,s]),this.U.rotate(Math.PI,[0,0,1]),this.U.rotate((180-116.57)*Math.PI/180,[1,0,0]),this.U.translate([0,0,s]),this.L.rotate(72*Math.PI/180,[0,0,1]),this.L.rotate(Math.PI,[0,0,1]),this.L.rotate((180-116.57)*Math.PI/180,[1,0,0]),this.L.translate([0,0,s]),this.R.rotate(72*Math.PI/180,[0,0,1]),this.R.rotate(Math.PI/5,[0,0,1]),this.R.rotate((180-116.57)*Math.PI/180,[1,0,0]),this.R.translate([0,0,s]),this.dr.rotate(72*Math.PI/180,[0,0,1]),this.dr.rotate(-Math.PI/5,[0,0,1]),this.dr.rotate((180-116.57)*Math.PI/180,[1,0,0]),this.dr.translate([0,0,s]),this.dl.rotate(72*Math.PI/180,[0,0,1]),this.dl.rotate(-3*Math.PI/5,[0,0,1]),this.dl.rotate((180-116.57)*Math.PI/180,[1,0,0]),this.dl.translate([0,0,s]),this.BL.rotate(Math.PI/5,[0,0,1]),this.BL.rotate(-116.57*Math.PI/180,[1,0,0]),this.BL.translate([0,0,s]),this.BR.rotate(-Math.PI/5,[0,0,1]),this.BR.rotate(-116.57*Math.PI/180,[1,0,0]),this.BR.translate([0,0,s]),this.bl.rotate(3*Math.PI/5,[0,0,1]),this.bl.rotate(-116.57*Math.PI/180,[1,0,0]),this.bl.translate([0,0,s]),this.d.rotate(5*Math.PI/5,[0,0,1]),this.d.rotate(-116.57*Math.PI/180,[1,0,0]),this.d.translate([0,0,s]),this.br.rotate(7*Math.PI/5,[0,0,1]),this.br.rotate(-116.57*Math.PI/180,[1,0,0]),this.br.translate([0,0,s]),this.stickers=[this.U,this.F,this.R,this.dr,this.dl,this.L,this.d,this.br,this.BR,this.BL,this.bl,this.b],this.faces={U:this.U,F:this.F,R:this.R,dr:this.dr,dl:this.dl,L:this.L,d:this.d,br:this.br,BR:this.BR,BL:this.BL,bl:this.bl,b:this.b},this.group=new Group(this.stickers)}setColors(t){let{U:e,R:s,F:i,d:r,L:o,b:a,dr:n,dl:h,br:c,BR:l,BL:u,bl:d}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,s),this.setFaceColors(this.F,i),this.setFaceColors(this.d,r),this.setFaceColors(this.L,o),this.setFaceColors(this.b,a),this.setFaceColors(this.dr,n),this.setFaceColors(this.dl,h),this.setFaceColors(this.BR,l),this.setFaceColors(this.BL,u),this.setFaceColors(this.bl,d),this.setFaceColors(this.br,c)}setFaceColors(t,e){t.faces.forEach(((t,s)=>{e&&e[s]?t.color=e[s]:t.color=v}))}}function ne(t,e,s){const i=t/2,r=t/e,o=r/2;let a=[];for(let n=0;n<e;n++){let h=-(-i+o+r*n);a=a.concat(he(t,e,s,h))}return a}function he(t,e,s,i=0){const r=t/2,o=t/e,a=o/2;let n=[];for(let t=0;t<e;t++){let e=-r+a+o*t,h=[[-a+e,a+i,0],[a+e,a+i,0],[a+e,-a+i,0],[-a+e,-a+i,0]],c=[new Face([0,1,2,3],h,s)];n.push(new Geometry(h,c))}return n}class RubiksCubeTopLayer{constructor(t,e=Math.PI/4){this.size=t,this.stickerWidth=.5,this.halfStickerWidth=this.stickerWidth/2,this.cubeWidth=this.stickerWidth*t,this.halfCubeWidth=this.cubeWidth/2,this.U=new Group(ne(this.cubeWidth,this.size,b)),this.R=new Group(he(this.cubeWidth,this.size,p)),this.F=new Group(he(this.cubeWidth,this.size,m)),this.B=new Group(he(this.cubeWidth,this.size,k)),this.L=new Group(he(this.cubeWidth,this.size,w));const s=this.halfCubeWidth+this.halfStickerWidth;this.B.translate([0,s,0]),this.B.rotate(Math.PI,[0,0,1]),this.F.translate([0,-s,0]),this.R.translate([s,0,0]),this.R.rotate(Math.PI/2,[0,0,1]),this.L.translate([-s,0,0]),this.L.rotate(-Math.PI/2,[0,0,1]),this.rotateBorder(this.F.objects,e),this.rotateBorder(this.R.objects,e),this.rotateBorder(this.B.objects,e),this.rotateBorder(this.L.objects,e),this.stickers=[this.U,this.R,this.F,this.B,this.L],this.group=new Group(this.stickers),this.faces={U:this.U,R:this.R,F:this.F,L:this.L,B:this.B}}setFaceColors(t,e){t.objects.forEach(((t,s)=>{e&&e[s]?t.faces[0].color=e[s]:t.faces[0].color=v}))}setColors(t){let{U:e,R:s,F:i,L:r,B:o}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,s),this.setFaceColors(this.F,i),this.setFaceColors(this.L,r),this.setFaceColors(this.B,o)}rotateBorder(t,e){t.forEach((t=>{t.vertices=t.vertices.map((t=>{return s=t,i=t,r=[0,this.halfStickerWidth,0],o=e,n=[],(a=[])[0]=i[0]-r[0],a[1]=i[1]-r[1],a[2]=i[2]-r[2],n[0]=a[0],n[1]=a[1]*Math.cos(o)-a[2]*Math.sin(o),n[2]=a[1]*Math.sin(o)+a[2]*Math.cos(o),s[0]=n[0]+r[0],s[1]=n[1]+r[1],s[2]=n[2]+r[2],s;var s,i,r,o,a,n})),t.centroid=zt(t.vertices)}))}}class RubiksCubeNet{constructor(t){this.size=t;const e=ne(1,t,b),s=ne(1,t,p),i=ne(1,t,m),r=ne(1,t,g),o=ne(1,t,w),a=ne(1,t,k);this.U=new Group(e),this.U.translate([0,1,0]),this.R=new Group(s),this.R.translate([1,0,0]),this.F=new Group(i),this.D=new Group(r),this.D.translate([0,-1,0]),this.L=new Group(o),this.L.translate([-1,0,0]),this.B=new Group(a),this.B.translate([2,0,0]),this.stickers=[this.U,this.R,this.F,this.D,this.L,this.B],this.faces={U:this.U,R:this.R,F:this.F,D:this.D,L:this.L,B:this.B},this.group=new Group(this.stickers),this.group.translate([-1/4,0,0]),this.group.scale([.5,.5,.5])}setFaceColors(t,e){t.objects.forEach(((t,s)=>{e&&e[s]?t.faces[0].color=e[s]:t.faces[0].color=v}))}setColors(t){let{U:e,R:s,F:i,D:r,L:o,B:a}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,s),this.setFaceColors(this.F,i),this.setFaceColors(this.D,r),this.setFaceColors(this.L,o),this.setFaceColors(this.B,a)}}class RubiksCube{constructor(t){this.size=t;const e=1.25,s=.625;this.U=new Group(ne(e,t,b)),this.R=new Group(ne(e,t,p)),this.F=new Group(ne(e,t,m)),this.D=new Group(ne(e,t,g)),this.L=new Group(ne(e,t,w)),this.B=new Group(ne(e,t,k)),this.U.rotate(-Math.PI/2,[0,1,0]),this.U.rotate(-Math.PI/2,[1,0,0]),this.U.translate([0,0,s]),this.R.translate([0,0,s]),this.F.rotate(-Math.PI/2,[0,1,0]),this.F.translate([0,0,s]),this.D.rotate(-Math.PI/2,[0,1,0]),this.D.rotate(Math.PI/2,[1,0,0]),this.D.translate([0,0,s]),this.L.rotate(-Math.PI,[0,1,0]),this.L.translate([0,0,s]),this.B.rotate(Math.PI/2,[0,1,0]),this.B.translate([0,0,s]),this.stickers=[this.U,this.R,this.F,this.D,this.L,this.B],this.faces={U:this.U,R:this.R,F:this.F,D:this.D,L:this.L,B:this.B},this.group=new Group(this.stickers)}setFaceColors(t,e){t.objects.forEach(((t,s)=>{e&&e[s]?t.faces[0].color=e[s]:t.faces[0].color=v}))}setColors(t){let{U:e,R:s,F:i,D:r,L:o,B:a}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,s),this.setFaceColors(this.F,i),this.setFaceColors(this.D,r),this.setFaceColors(this.L,o),this.setFaceColors(this.B,a)}}class Arrow extends Object3D{constructor(t,e){super(),this.p1=t,this.p2=e,this.centroid=zt([t,e])}}function ce(t,e,s,i){const r=function(t){return t.reduce(((t,e)=>`${t?t+" ":""}${e[0]}, ${e[1]}`),"")}(e),o=s?s.value:"black",a=s&&s.stroke||"#000000";t.setAttributeNS(null,"points",r),t.setAttributeNS(null,"fill",o),i&&(t.setAttributeNS(null,"stroke",a),t.setAttributeNS(null,"stroke-width",i)),t.setAttributeNS(null,"stroke-linejoin","round")}function le(t,e){return e.reduce(((t,e)=>{return s=t,r=e,o=(i=t)[0],a=i[1],n=i[2],h=(h=r[3]*o+r[7]*a+r[11]*n+r[15])||1,s[0]=(r[0]*o+r[4]*a+r[8]*n+r[12])/h,s[1]=(r[1]*o+r[5]*a+r[9]*n+r[13])/h,s[2]=(r[2]*o+r[6]*a+r[10]*n+r[14])/h,s;var s,i,r,o,a,n,h}),Lt(t))}class CustomSVGRenderer{constructor(t,e,s,i,r,o,a){this.strokeWidth="0.035",this.arrowStrokeWidth="0.03",this.polygons=[],this.lines=[],this.uidToPolygon={},this.uidToLine={},this.arrowColor=a||v,this.domElement=document.createElement("div"),this.domElement.className="svg-renderer",this.svgElement=function(t,e,s,i,r,o){const a=document.createElementNS("http://www.w3.org/2000/svg","svg");return a.setAttributeNS(null,"width",t.toString()),a.setAttributeNS(null,"height",e.toString()),a.setAttributeNS(null,"viewBox",`${s} ${i} ${r} ${o}`),a.setAttributeNS(null,"id","sr-visualizer"),a}(t,e,s,i,r,o);const n=function(t){const e=document.createElementNS("http://www.w3.org/2000/svg","defs"),s=document.createElementNS("http://www.w3.org/2000/svg","marker");s.setAttributeNS(null,"id","arrowhead"),s.setAttributeNS(null,"markerWidth","4"),s.setAttributeNS(null,"markerHeight","3.5"),s.setAttributeNS(null,"refX","3"),s.setAttributeNS(null,"refY","1.75"),s.setAttributeNS(null,"orient","auto");const i=document.createElementNS("http://www.w3.org/2000/svg","polygon");return i.setAttributeNS(null,"points","0 0, 4 1.75, 0 3.5"),i.setAttributeNS(null,"fill",t.value),e.appendChild(s),s.appendChild(i),e}(this.arrowColor);this.svgElement.appendChild(n),this.domElement.appendChild(this.svgElement)}render(t,e){this.polygons=[],this.lines=[],t.objects.forEach((t=>{this.renderObject3D(t,e,[])})),this.renderPolygons(),this.renderLines()}renderPolygons(){this.polygons.sort(((t,e)=>t.centroid[2]-e.centroid[2])),this.polygons.forEach((t=>this.svgElement.appendChild(t.polygon)))}renderLines(){this.lines.forEach((t=>{this.svgElement.appendChild(t)}))}addPolygon(t,e,s,i){if(this.uidToPolygon[e.uid]){ce(this.uidToPolygon[e.uid],t,e.color||s.color,this.strokeWidth)}else this.uidToPolygon[e.uid]=function(t,e,s){const i=document.createElementNS("http://www.w3.org/2000/svg","polygon");return ce(i,t,e,s),i}(t,e.color||s.color,this.strokeWidth);this.polygons.push({polygon:this.uidToPolygon[e.uid],centroid:le(e.centroid,[s.matrix,...i])})}renderObject3D(t,e,s){if(t instanceof Geometry)this.renderGeometry(t,e,s);else if(t instanceof Arrow)this.renderArrow(t,e,s);else if(t instanceof Group){let i=t;this.sortObjects(i.objects,e,[i.matrix,...s]),i.objects.forEach((t=>{this.renderObject3D(t,e,[i.matrix,...s])}))}}renderGeometry(t,e,s){t.faces.forEach((i=>{let r=[];i.indices.map((e=>t.vertices[e])).forEach((i=>{let o=le(i,[t.matrix,...s,e.matrix]),a=Pt(o,o,[1,-1,1]);r.push(a)})),this.addPolygon(r,i,t,s)}))}renderArrow(t,e,s){let i,r=[t.matrix,...s,e.matrix],o=le(t.p1,r),a=le(t.p2,r);this.uidToLine[t.uid]?(i=this.uidToLine[t.uid],i.setAttributeNS(null,"x1",o[0].toString()),i.setAttributeNS(null,"y1",(-o[1]).toString()),i.setAttributeNS(null,"x2",a[0].toString()),i.setAttributeNS(null,"y2",(-a[1]).toString())):(i=function(t,e,s,i){const r=document.createElementNS("http://www.w3.org/2000/svg","line");let o=s?s.value:v.value;return r.setAttributeNS(null,"x1",t[0].toString()),r.setAttributeNS(null,"y1",(-t[1]).toString()),r.setAttributeNS(null,"x2",e[0].toString()),r.setAttributeNS(null,"y2",(-e[1]).toString()),r.setAttributeNS(null,"stroke",o),r.setAttributeNS(null,"marker-end","url(#arrowhead)"),i&&r.setAttributeNS(null,"stroke-width",i),r}(o,a,this.arrowColor,this.arrowStrokeWidth),this.uidToLine[t.uid]=i),this.lines.push(i)}sortFaces(t,e,s){t.sort(((t,i)=>{let r=[e.matrix,...s],o=[e.matrix,...s],a=le(t.centroid,r),n=le(i.centroid,o);return a[2]-n[2]}))}sortObjects(t,e,s){t.sort(((t,e)=>{let i=[t.matrix,...s],r=[e.matrix,...s],o=le(t.centroid,i),a=le(e.centroid,r);return o[2]-a[2]}))}}class Camera{constructor(){var t,e,s,i,r,o,a;this.matrix=At(),t=this.matrix,e=Math.PI/2,s=1,i=.1,r=1e3,a=1/Math.tan(e/2),t[0]=a/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),Ot(this.matrix,this.matrix,[0,0,-5]),jt(this.matrix,this.matrix,[4,4,1])}}class Scene{constructor(){this.objects=[]}add(t){this.objects.push(t)}clear(){this.objects=[]}}var ue;!function(t){t.CUBE="cube",t.CUBE_NET="cube-net",t.CUBE_TOP="cube-top",t.MEGAMINX="megaminx",t.MEGAMINX_NET="megaminx-net",t.MEGAMINX_TOP="megaminx-top",t.PYRAMINX="pyraminx",t.PYRAMINX_NET="pyraminx-net",t.SKEWB="skewb",t.SKEWB_NET="skewb-net",t.SQUARE1="square1",t.SQUARE1_NET="square1-net"}(ue||(ue={}));const de={size:3,scheme:{U:b,R:p,F:m,D:g,L:w,B:k},rotations:[{x:0,y:45,z:0},{x:34,y:0,z:0}]},fe={size:2,scheme:{U:g,F:p,R:m,dr:R,dl:F,L:k,d:y,br:E,BR:b,BL:S,bl:C,b:w}},be={size:3,scheme:{left:m,right:k,top:b,back:p},rotations:[{x:0,y:0,z:60},{x:-60,y:0,z:0}]},pe={scheme:{top:b,front:m,right:p,back:k,left:w,bottom:g},rotations:[{x:0,y:45,z:0},{x:34,y:0,z:0}]},me={scheme:Y,rotations:[{x:0,y:0,z:-34},{x:-56,y:0,z:0}]};!function(){var t,e=(t=new Rt(4),Rt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function ge(){var t=new Rt(4);return Rt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function we(t,e,s,i){var r,o,a,n,h,c=e[0],l=e[1],u=e[2],d=e[3],f=s[0],b=s[1],p=s[2],m=s[3];return c*f+l*b+u*p+d*m<0&&(-o,-f,-b,-p,-m),1-o>Et?(Math.acos(o),Math.sin(r),Math.sin((1-i)*r)/a,Math.sin(i*r)/a):(1-i,i),t[0]=n*c+h*f,t[1]=n*l+h*b,t[2]=n*u+h*p,t[3]=n*d+h*m,t}var ke,Se,ye,Ce,Fe,Ee,Re,ve=function(t,e){var s=e[0],i=e[1],r=e[2],o=e[3],a=s*s+i*i+r*r+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=s*a,t[1]=i*a,t[2]=r*a,t[3]=o*a,t};ke=vt(),Se=Mt(1,0,0),ye=Mt(0,1,0),Ce=ge(),Fe=ge(),Ee=new Rt(9),Rt!=Float32Array&&(Ee[1]=0,Ee[2]=0,Ee[3]=0,Ee[5]=0,Ee[6]=0,Ee[7]=0),Ee[0]=1,Ee[4]=1,Ee[8]=1,Re=Ee;function Le(t){if(t.alg&&"string"!=typeof t.alg&&(console.warn(`Inavlid alg ${t.alg}. alg must be a string`),t.alg=""),t.case&&"string"!=typeof t.case&&(console.warn(`Inavlid case ${t.case}. case must be a string`),t.case=""),t.scheme&&("object"!=typeof t.scheme||Array.isArray(t.scheme)?(console.warn(`Invalid scheme ${t.scheme}. scheme must be an object`),t.scheme={}):Object.keys(t.scheme).forEach((e=>{const s=t.scheme[e];null!=s&&"object"==typeof s&&s.value||(console.warn(`Invalid scheme color ${s}. must be an type IColor`),t.scheme[e]=v)}))),t.mask&&("object"!=typeof t.mask||Array.isArray(t.mask)?(console.warn(`Invalid mask ${t.mask}. scheme must be an object`),t.mask={}):Object.keys(t.mask).forEach((e=>{const s=t.mask[e];if(Array.isArray(s)){for(let i=0;i<s.length;i++)if(!Number.isInteger(s[i])){console.warn(`Invalid mask value ${s[i]}. must be a number`),t.mask[e]=[];break}}else console.warn(`Invalid mask ${s}. must be an array`),t.mask[e]=[]}))),t.stickerColors&&("object"!=typeof t.stickerColors||Array.isArray(t.stickerColors)?(console.warn(`Invalid stickerColors ${t.stickerColors}. stickerColors must be an object`),t.stickerColors={}):Object.keys(t.stickerColors).forEach((e=>{const s=t.stickerColors[e];if(Array.isArray(s)){for(let i=0;i<s.length;i++)if(!Me(s[i])){t.stickerColors[e]=[];break}}else console.warn(`Invalid colors ${s}. must be an array`),t.stickerColors[e]=[]}))),t.rotations)if(Array.isArray(t.rotations)){for(let e=0;e<t.rotations.length;e++)if(!Pe(t.rotations[e])){t.rotations=[];break}}else console.warn(`invalid rotations ${t.rotations}, must be an array`),t.rotations=[];if(t.scale&&!Number.isFinite(t.scale)&&(console.warn(`invalid scale ${t.scale}, must be a finite number`),t.scale=1),t.translation&&!function(t){if("object"!=typeof t||Array.isArray(t))return console.warn(`invalid translation ${t}, must be an object`),!1;if(t.x&&!Number.isFinite(t.x))return console.warn(`invalid x translation ${t.x}, must be a number`),!1;if(t.y&&!Number.isFinite(t.y))return console.warn(`invalid y translation ${t.y}, must be a number`),!1;if(t.z&&!Number.isFinite(t.z))return console.warn(`invalid z translation ${t.z}, must be a number`),!1;return!0}(t.translation)&&(t.translation={x:0,y:0,z:0}),t.arrows)if(Array.isArray(t.arrows)){for(let e=0;e<t.arrows.length;e++)if(!Be(t.arrows[e])){t.arrows=[];break}}else console.warn("invalid arrows, must be an array"),t.arrows=[]}function Me(t){return"object"!=typeof t?(console.warn(`invalid color ${t}, must be type object`),!1):t.value&&"string"==typeof t.value?!t.stroke||"string"==typeof t.stroke||(console.warn(`invalid color stroke ${t.stroke}, must be type string`),!1):(console.warn(`invalid color value ${t.value}, must be type string`),!1)}function Pe(t){return t&&"object"==typeof t?t.x&&!Number.isFinite(t.x)?(console.warn(`invalid x rotation ${t.x}, must be a number`),!1):t.y&&!Number.isFinite(t.y)?(console.warn(`invalid y rotation ${t.y}, must be a number`),!1):!(t.z&&!Number.isFinite(t.z))||(console.warn(`invalid z rotation ${t.z}, must be a number`),!1):(console.warn(`invalid rotation ${t}, must be an object`),!1)}function Be(t){return"object"!=typeof t?(console.warn(`invalid arrow ${t}, must be an object`),!1):"object"!=typeof t.end||"object"!=typeof t.start?(console.warn(`invalid arrow ${t}, must have start and end`),!1):"string"==typeof t.start.face&&Number.isInteger(t.start.sticker)?!("string"!=typeof t.end.face||!Number.isInteger(t.end.sticker))||(console.warn(`invalid arrow end ${t.end}`),!1):(console.warn(`invalid arrow start ${t.start}`),!1)}const Te={2:.3,3:.17,4:.121};class MegaminxTop{constructor(){this.createFaces(),this.removeHiddenStickers()}createFaces(){const t=.75,e=function(t,e){return Te[e]||t/(1.9*e)}(t,2),s=Gt(t);this.U=new DividedPentagon(g,2,t,e),this.F=new DividedPentagon(p,2,t,e),this.R=new DividedPentagon(m,2,t,e),this.L=new DividedPentagon(k,2,t,e),this.BR=new DividedPentagon(b,2,t,e),this.BL=new DividedPentagon(S,2,t,e),this.F.translate([0,0,s]),this.U.rotate(Math.PI,[0,0,1]),this.U.rotate((180-116.57)*Math.PI/180,[1,0,0]),this.U.translate([0,0,s]),this.L.rotate(72*Math.PI/180,[0,0,1]),this.L.rotate(Math.PI,[0,0,1]),this.L.rotate((180-116.57)*Math.PI/180,[1,0,0]),this.L.translate([0,0,s]),this.R.rotate(72*Math.PI/180,[0,0,1]),this.R.rotate(Math.PI/5,[0,0,1]),this.R.rotate((180-116.57)*Math.PI/180,[1,0,0]),this.R.translate([0,0,s]),this.BL.rotate(Math.PI/5,[0,0,1]),this.BL.rotate(-116.57*Math.PI/180,[1,0,0]),this.BL.translate([0,0,s]),this.BR.rotate(-Math.PI/5,[0,0,1]),this.BR.rotate(-116.57*Math.PI/180,[1,0,0]),this.BR.translate([0,0,s]),this.faces={U:this.U,F:this.F,R:this.R,dr:this.BR,dl:this.BL,L:this.L},this.group=new Group([this.U,this.F,this.R,this.BR,this.BL,this.L]),this.group.rotate(Dt(63),[1,0,0])}setColors(t){let{U:e,R:s,F:i,L:r,BR:o,BL:a}=t;this.createFaces(),this.setFaceColors(this.U,e),this.setFaceColors(this.R,s),this.setFaceColors(this.F,i),this.setFaceColors(this.L,r),this.setFaceColors(this.BR,o),this.setFaceColors(this.BL,a),this.removeHiddenStickers()}setFaceColors(t,e){t.faces.forEach(((t,s)=>{e&&e[s]?t.color=e[s]:t.color=v}))}removeHiddenStickers(){this.F.faces=this.F.faces.slice(2,5),this.BL.faces=this.BL.faces.slice(8,11),this.L.faces=this.L.faces.slice(4,7),this.R.faces=[this.R.faces[1],this.R.faces[2],this.R.faces[10]],this.BR.faces=this.BR.faces.slice(6,9)}}function Ie(t){const e=new Square1Simualtor(t.scheme);return t.case?e.case(t.case):t.alg&&e.alg(t.alg),e}function xe(t,e){switch(t){case ue.CUBE:return function(t={}){return[new RubiksCube(t.size),new RubiksCubeSimulator(t.size)]}(e);case ue.CUBE_NET:return function(t={}){return[new RubiksCubeNet(t.size),new RubiksCubeSimulator(t.size)]}(e);case ue.CUBE_TOP:return function(t={}){return[new RubiksCubeTopLayer(t.size),new RubiksCubeSimulator(t.size)]}(e);case ue.MEGAMINX:return function(t={}){return[new Megaminx(t.size),new MegaminxSimulator]}(e);case ue.MEGAMINX_NET:return function(t={}){return[new MegaminxNet(t.size),new MegaminxSimulator]}(e);case ue.MEGAMINX_TOP:return[new MegaminxTop,new MegaminxSimulator];case ue.PYRAMINX:return function(t={}){return[new Pyraminx(t.size),new PyraminxSimulator]}(e);case ue.PYRAMINX_NET:return function(t={}){return[new PyraminxNet(t.size),new PyraminxSimulator]}(e);case ue.SKEWB:return[new Skewb,new SkewbSimulator];case ue.SKEWB_NET:return[new SkewbNet,new SkewbSimulator];case ue.SQUARE1:return function(t={}){const e=Ie(t);return[new Square1(e.topLayer,e.bottomLayer,e.middleRotated),e]}(e);case ue.SQUARE1_NET:return function(t={}){const e=Ie(t);return[new Square1Net(e.topLayer,e.bottomLayer,e.middleRotated),e]}(e)}}function Ne(t){return t===ue.SQUARE1||t===ue.SQUARE1_NET}function De(t,e){return function(t){return t===ue.PYRAMINX||t===ue.PYRAMINX_NET}(t)?3===e:!function(t){return t===ue.MEGAMINX||t===ue.MEGAMINX_NET||t===ue.MEGAMINX_TOP}(t)||2===e}class Visualizer{constructor(t,e,s={}){this.type=e,this.camera=new Camera,this.scene=new Scene,this.renderer=t,this.setPuzzleOptions(s),this.render()}applyColors(){const t=this.options.stickerColors&&!Ne(this.type),e=De(this.type,this.options.size);if(t)this.puzzleGeometry.setColors(this.options.stickerColors);else if(e)this.applySimulatorColors();else{const t=this.puzzleGeometry.faces;Object.keys(t).forEach((e=>{const s=t[e],i=this.options.scheme[e];s instanceof Geometry?s.faces.forEach((t=>t.color=i)):s instanceof Group&&s.objects.forEach((t=>t.color=i))}))}}applySimulatorColors(){this.options.mask&&this.applyMask(this.options),(this.options.alg||this.options.case)&&this.applyAlgorithm();const t=function(t,e){return Object.keys(t).reduce(((s,i)=>(s[i]=t[i].map((t=>e[t]||L)),s)),{})}(this.simulator.getValues(),this.options.scheme);this.puzzleGeometry.setColors(t)}applyAlgorithm(){Ne(this.type)||(this.options.case?this.simulator.case(this.options.case):this.options.alg&&this.simulator.alg(this.options.alg))}applyMask(t){Object.keys(t.mask).forEach((e=>{t.mask[e].forEach((t=>this.simulator.setValue(e,t,"mask")))}))}buildGroupMatrix(){if(this.options.rotations){let t=At();this.options.rotations.forEach((e=>{const{x:s=0,y:i=0,z:r=0}=e;$t(t,function(t,e){var s=e[0],i=e[1],r=e[2],o=e[3],a=s+s,n=i+i,h=r+r,c=s*a,l=i*a,u=i*n,d=r*a,f=r*n,b=r*h,p=o*a,m=o*n,g=o*h;return t[0]=1-u-b,t[1]=l+g,t[2]=d-m,t[3]=0,t[4]=l-g,t[5]=1-c-b,t[6]=f+p,t[7]=0,t[8]=d+m,t[9]=f-p,t[10]=1-c-u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(At(),function(t,e,s,i){var r=.5*Math.PI/180;e*=r,s*=r,i*=r;var o=Math.sin(e),a=Math.cos(e),n=Math.sin(s),h=Math.cos(s),c=Math.sin(i),l=Math.cos(i);return t[0]=o*h*l-a*n*c,t[1]=a*n*l+o*h*c,t[2]=a*h*c-o*n*l,t[3]=a*h*l+o*n*c,t}(ge(),s,i,r)),t)})),$t(this.puzzleGeometry.group.matrix,At(),t)}if(this.options.scale){let t=this.options.scale;jt(this.puzzleGeometry.group.matrix,this.puzzleGeometry.group.matrix,Mt(t,t,t))}if(this.options.translation){const{x:t=0,y:e=0,z:s=0}=this.options.translation;let i=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}(At(),Mt(t,e,s));$t(this.puzzleGeometry.group.matrix,i,this.puzzleGeometry.group.matrix)}}addArrows(){this.options.arrows&&this.options.arrows.forEach((t=>{try{this.scene.add(function(t,e){var s,i,r,o,a,n,h,c;let l=e.faces[t.start.face],u=e.faces[t.end.face];if(!l||!u)throw new Error(`Invalid arrow definition ${JSON.stringify(t)}`);let d,f,b=[l.matrix,e.group.matrix],p=[u.matrix,e.group.matrix];if(l instanceof Geometry&&u instanceof Geometry?(d=null===(s=l.faces[t.start.sticker])||void 0===s?void 0:s.centroid,f=null===(i=u.faces[t.end.sticker])||void 0===i?void 0:i.centroid):(e instanceof Square1?(d=null===(r=l.objects[t.start.sticker])||void 0===r?void 0:r.faces[0].centroid,f=null===(o=u.objects[t.end.sticker])||void 0===o?void 0:o.faces[0].centroid):(d=null===(a=l.objects[t.start.sticker])||void 0===a?void 0:a.centroid,f=null===(n=u.objects[t.end.sticker])||void 0===n?void 0:n.centroid),b.unshift(null===(h=l.objects[t.start.sticker])||void 0===h?void 0:h.matrix),p.unshift(null===(c=u.objects[t.end.sticker])||void 0===c?void 0:c.matrix)),!d||!f)throw new Error(`Invalid arrow definition ${JSON.stringify(t)}`);let m=le(d,b),g=le(f,p);return new Arrow(m,g)}(t,this.puzzleGeometry))}catch(e){console.warn(`Invalid arrow ${JSON.stringify(t)}`)}}))}setPuzzleOptions(t){this.options=Object.assign(Object.assign({},function(t){switch(t){case ue.CUBE:return de;case ue.CUBE_NET:case ue.CUBE_TOP:return Object.assign(Object.assign({},de),{rotations:null});case ue.MEGAMINX:case ue.MEGAMINX_NET:case ue.MEGAMINX_TOP:return fe;case ue.PYRAMINX:return be;case ue.PYRAMINX_NET:return Object.assign(Object.assign({},be),{rotations:null});case ue.SKEWB:return pe;case ue.SKEWB_NET:return Object.assign(Object.assign({},pe),{rotations:null});case ue.SQUARE1:return me;case ue.SQUARE1_NET:return Object.assign(Object.assign({},me),{rotations:null});default:throw new Error(`Could not get default options for puzzle ${t}`)}}(this.type)),t),Le(this.options),[this.puzzleGeometry,this.simulator]=xe(this.type,this.options),this.buildGroupMatrix(),this.applyColors(),this.scene.clear(),this.scene.add(this.puzzleGeometry.group),this.addArrows()}render(){this.renderer.render(this.scene,this.camera)}}const Ue={width:500,height:500,minx:-.9,miny:-.9,svgWidth:1.8,svgHeight:1.8,strokeWidth:.02,arrowColor:y,arrowStrokeWidth:.03};function Ge(t,e,s={}){return new SvgVisualizer(t,e,s)}class SvgVisualizer extends Visualizer{constructor(t,e,s={}){if(s=Object.assign(Object.assign({},Ue),s),"string"==typeof t&&null===(t=document.querySelector(t)))throw new Error(`Could not find visuzlier element by query selector: ${t}`);const i=new CustomSVGRenderer(s.width,s.height,s.minx,s.miny,s.svgWidth,s.svgHeight,s.arrowColor);i.strokeWidth=""+s.strokeWidth,t.appendChild(i.domElement),super(i,e,s.puzzle),this.svgOptions=s}setStrokeWidth(t){this.svgOptions.strokeWidth=t,this.renderer.strokeWidth=""+this.svgOptions.strokeWidth,this.render()}setSvgOptions(t){this.svgOptions=Object.assign(Object.assign({},Ue),t),function(t){Number.isInteger(t.width)||(console.warn(`invalid svg width ${t.width}. Must be a whole number`),t.width=Ue.width);Number.isInteger(t.height)||(console.warn(`invalid svg height ${t.height}. Must be a whole number`),t.width=Ue.height);Number.isFinite(t.minx)||(console.warn(`invalid svg minx ${t.minx}`),t.minx=Ue.minx);Number.isFinite(t.miny)||(console.warn(`invalid svg miny ${t.miny}`),t.minx=Ue.miny);Number.isFinite(t.svgWidth)||(console.warn(`invalid svgWidth ${t.svgWidth}`),t.minx=Ue.svgWidth);Number.isFinite(t.svgHeight)||(console.warn(`invalid svgHeight ${t.svgHeight}`),t.minx=Ue.svgHeight);Number.isFinite(t.strokeWidth)||(console.warn(`invalid strokeWidth ${t.strokeWidth}`),t.minx=Ue.strokeWidth);Number.isFinite(t.arrowStrokeWidth)||(console.warn(`invalid arrowStrokeWidth ${t.arrowStrokeWidth}`),t.minx=Ue.arrowStrokeWidth);t.arrowColor&&!Me(t.arrowColor)&&(t.arrowColor=v)}(this.svgOptions);const e=this.renderer,s=e.svgElement;e.strokeWidth=""+this.svgOptions.strokeWidth,e.arrowStrokeWidth=""+this.svgOptions.arrowStrokeWidth,s.setAttributeNS(null,"width",this.svgOptions.width.toString()),s.setAttributeNS(null,"height",this.svgOptions.width.toString()),s.setAttributeNS(null,"viewBox",`${this.svgOptions.minx} ${this.svgOptions.miny} ${this.svgOptions.svgWidth} ${this.svgOptions.svgHeight}`),this.render()}}const ze={width:500,height:500,minx:-.9,miny:-.9,svgWidth:1.8,svgHeight:1.8,strokeWidth:.02,arrowColor:y,arrowStrokeWidth:.03};function Ae(t,e,s={}){if("string"==typeof t&&null===(t=document.querySelector(t)))throw new Error(`Could not find visuzlier element by query selector: ${t}`);let i=document.createElement("div");s=Object.assign(Object.assign({},ze),s),Ge(i,e,s),setTimeout((()=>{let e=i.querySelector("svg"),r=document.createElement("img");t.appendChild(r);let o=document.createElement("canvas"),a=o.getContext("2d"),n=new Image;n.width=o.width=r.width=s.width,n.height=o.height=r.height=s.height,n.onload=function(){a.drawImage(n,0,0,n.width,n.height),r.src=o.toDataURL()};var h=(new XMLSerializer).serializeToString(e);n.src=`data:image/svg+xml,${encodeURIComponent(h)}`}))}const Oe={CUBE_3:{LAST_LAYER:{F:[3,4,5,6,7,8],B:[3,4,5,6,7,8],R:[3,4,5,6,7,8],L:[3,4,5,6,7,8],D:[0,1,2,3,4,5,6,7,8]},F2L:{F:[0,1,2],B:[0,1,2],R:[0,1,2],L:[0,1,2],U:[0,1,2,3,4,5,6,7,8]},FIRST_LAYER:{F:[0,1,2,3,4,5],B:[0,1,2,3,4,5],R:[0,1,2,3,4,5],L:[0,1,2,3,4,5],U:[0,1,2,3,4,5,6,7,8]},OLL:{R:[0,1,2,3,4,5,6,7,8],F:[0,1,2,3,4,5,6,7,8],D:[0,1,2,3,4,5,6,7,8],L:[0,1,2,3,4,5,6,7,8],B:[0,1,2,3,4,5,6,7,8]},CORNERS_LAST_LAYER:{U:[1,3,5,7],F:[1,3,4,5,6,7,8],B:[1,3,4,5,6,7,8],R:[1,3,4,5,6,7,8],L:[1,3,4,5,6,7,8],D:[0,1,2,3,4,5,6,7,8]},EDGES_LAST_LAYER:{U:[0,2,6,8],F:[0,2,3,4,5,6,7,8],B:[0,2,3,4,5,6,7,8],R:[0,2,3,4,5,6,7,8],L:[0,2,3,4,5,6,7,8],D:[0,1,2,3,4,5,6,7,8]}},MEGA_3:{OLL:{F:[0,1,2,3,4,5,6,7,8,9,10],R:[0,1,2,3,4,5,6,7,8,9,10],L:[0,1,2,3,4,5,6,7,8,9,10],BR:[0,1,2,3,4,5,6,7,8,9,10],BL:[0,1,2,3,4,5,6,7,8,9,10],d:[0,1,2,3,4,5,6,7,8,9,10],b:[0,1,2,3,4,5,6,7,8,9,10],dl:[0,1,2,3,4,5,6,7,8,9,10],dr:[0,1,2,3,4,5,6,7,8,9,10],bl:[0,1,2,3,4,5,6,7,8,9,10],br:[0,1,2,3,4,5,6,7,8,9,10]}}},je={Scene,Camera,CustomSVGRenderer},We={RubiksCube,RubiksCubeNet,RubiksCubeTopLayer,Megaminx,MegaminxNet,Pyraminx,PyraminxNet,Skewb,SkewbNet,Square1,Square1Net},$e={RubiksCubeSimulator,MegaminxSimulator,PyraminxSimulator,SkewbSimulator,Square1Simualtor},_e={TurnType:i,parseCubeAlgorithm:l,parseMegaminxAlgorithm:mt,parsePyraminxAlgorithm:ut,parseSkewbAlgorithm:st,parseSquare1Algorithm:Q}}},e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i](r,r.exports,s),r.exports}return s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s(302)})()}));
//# sourceMappingURL=puzzleGen.min.js.map